{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "# Building a Knowledge Graph"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pyspark as sp\n",
    "import numpy as np\n",
    "import string\n",
    "import re"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Required for environment variable"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "os.environ[\"PYSPARK_PYTHON\"]=\"/usr/local/bin/python3\"\n",
    "os.environ[\"PYSPARK_DRIVER_PYTHON\"]=\"/usr/local/bin/python3\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Setup cluster"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark.sql import SparkSession\n",
    "\n",
    "spark = SparkSession \\\n",
    "    .builder \\\n",
    "    .appName(\"Python Knowledge Graph Project\") \\\n",
    "    .master(\"local[*]\") \\\n",
    "    .config(\"spark.some.config.option\", \"some-value\") \\\n",
    "    .getOrCreate()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# sc.defaultParallelism"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###  Load dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_keywords = spark.read.csv(\"./mag_cs_keywords.csv\",header=True)\n",
    "df_arxiv = spark.read.json(\"./original/arxiv-metadata-oai-snapshot.json\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_keywords = df_keywords.repartition(8)\n",
    "df_arxiv = df_arxiv.repartition(8)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_keywords.rdd.getNumPartitions()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "104654"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_keywords.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "abstracts = df_arxiv.select(\"id\",\"abstract\")\n",
    "keywords = df_keywords.select(\"normalizedName\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Cleaning & Normalization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark.sql.functions import udf, col\n",
    "from pyspark.sql import Row\n",
    "from pyspark.sql.types import ArrayType, StructField, StructType, StringType, IntegerType\n",
    "\n",
    "# remove non ASCII characters & lowercase\n",
    "def strip_non_ascii(data_str):\n",
    "    ''' Returns the string without non ASCII characters'''\n",
    "    stripped = (c.lower() for c in data_str if 96 < ord(c.lower()) < 123 or ord(c)==32) #alphabets\n",
    "\n",
    "    return ''.join(stripped)\n",
    "# setup pyspark udf function\n",
    "strip_non_ascii_udf = udf(strip_non_ascii, StringType())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "abstracts = abstracts.withColumn('normalized', strip_non_ascii_udf(abstracts['abstract']))\n",
    "abstracts = abstracts.select(\"id\",\"normalized\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1. Extract keywords in document\n",
    "    - https://stackoverflow.com/questions/48869922/how-to-efficiently-check-if-a-list-of-words-is-contained-in-a-spark-dataframe\n",
    "    - https://stackoverflow.com/questions/46410887/pyspark-string-matching-to-create-new-column\n",
    "\n",
    "   \n",
    "2. Build Co-occurence matrix\n",
    "    - https://stackoverflow.com/questions/48551900/spark-generate-occurrence-matrix\n",
    "   \n",
    "   \n",
    "3. Useful tutorials\n",
    "   - https://spark.apache.org/docs/1.6.3/ml-features.html"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+---------+--------------------+\n",
      "|       id|          normalized|\n",
      "+---------+--------------------+\n",
      "|0809.3647|  in this paper w...|\n",
      "|0809.1984|  quantum fluctua...|\n",
      "|0710.3204|  we show how com...|\n",
      "|0704.3898|  we give two cla...|\n",
      "|0807.4706|  let g be a grou...|\n",
      "|0809.2915|  the h and zeus ...|\n",
      "|0803.3905|  when designing ...|\n",
      "|0807.0026|  radio telescope...|\n",
      "|0804.1504|  in  an internat...|\n",
      "|0802.4266|  we study group ...|\n",
      "|0802.3187|  the role of neu...|\n",
      "|0710.2708|  given a project...|\n",
      "|0706.0677|  this is the thi...|\n",
      "|0707.1652|  the pierre auge...|\n",
      "|0809.1051|  we present a ve...|\n",
      "|0704.3951|  ramification in...|\n",
      "|0805.4670|  based on firstp...|\n",
      "|0710.4428|  an asymptotic m...|\n",
      "|0712.1683|  recently the in...|\n",
      "|0810.0015|  experiments in ...|\n",
      "+---------+--------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "abstracts.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Keyword List for Query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "keywords_list = list(keywords.select('normalizedName').toPandas()['normalizedName'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "keywords_list2 = [\"fully\", \"different\", \"paper\", \"we\"] # small numbers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "keyword_dict = {word:0 for word in keywords_list}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Extract Keyword from the keyword list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "\n",
    "# Define the function you want to return\n",
    "def extract(s):\n",
    "    all_matches = set()\n",
    "    for word in s.split(\" \"): \n",
    "        if keyword_dict.get(word, -1) >=0: \n",
    "            keyword_dict[word] += 1\n",
    "            all_matches.add(word)\n",
    "    return ','.join(all_matches)\n",
    "\n",
    "# Create the UDF, note that you need to declare the return schema matching the returned type\n",
    "extract_udf = udf(extract, StringType())\n",
    "\n",
    "# Apply it\n",
    "df = abstracts.withColumn('extracted', extract_udf(abstracts['normalized']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+---------+--------------------+--------------------+\n",
      "|       id|          normalized|           extracted|\n",
      "+---------+--------------------+--------------------+\n",
      "|0809.3647|  in this paper w...|size,algorithm,pr...|\n",
      "|0809.1984|  quantum fluctua...|quantum,field,res...|\n",
      "|0710.3204|  we show how com...|current,scatterin...|\n",
      "|0704.3898|  we give two cla...|set,metric,functi...|\n",
      "|0807.4706|  let g be a grou...|product,cluster,q...|\n",
      "|0809.2915|  the h and zeus ...|scattering,mass,q...|\n",
      "|0803.3905|  when designing ...|set,art,modelling...|\n",
      "|0807.0026|  radio telescope...|range,leakage,pos...|\n",
      "|0804.1504|  in  an internat...|imagination,refle...|\n",
      "|0802.4266|  we study group ...| bimodule,skew,group|\n",
      "|0802.3187|  the role of neu...|quark,phase,gauge...|\n",
      "|0710.2708|  given a project...|bundle,decomposit...|\n",
      "|0706.0677|  this is the thi...|geodesic,link,ser...|\n",
      "|0707.1652|  the pierre auge...|pose,unit,distrib...|\n",
      "|0809.1051|  we present a ve...|range,quantum,res...|\n",
      "|0704.3951|  ramification in...|filtration,struct...|\n",
      "|0805.4670|  based on firstp...|character,layers,...|\n",
      "|0710.4428|  an asymptotic m...|structures,dynami...|\n",
      "|0712.1683|  recently the in...|wave,molecule,dif...|\n",
      "|0810.0015|  experiments in ...|cell,relation,low...|\n",
      "+---------+--------------------+--------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "df.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Drop Empty Rows where no keyword exists"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark.sql.functions import length\n",
    "df = df.filter(length('extracted')>2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+---------+--------------------+--------------------+\n",
      "|       id|          normalized|           extracted|\n",
      "+---------+--------------------+--------------------+\n",
      "|0809.3647|  in this paper w...|size,algorithm,pr...|\n",
      "|0809.1984|  quantum fluctua...|quantum,field,res...|\n",
      "|0710.3204|  we show how com...|current,scatterin...|\n",
      "|0704.3898|  we give two cla...|set,metric,functi...|\n",
      "|0807.4706|  let g be a grou...|product,cluster,q...|\n",
      "|0809.2915|  the h and zeus ...|scattering,mass,q...|\n",
      "|0803.3905|  when designing ...|set,art,modelling...|\n",
      "|0807.0026|  radio telescope...|range,leakage,pos...|\n",
      "|0804.1504|  in  an internat...|imagination,refle...|\n",
      "|0802.4266|  we study group ...| bimodule,skew,group|\n",
      "|0802.3187|  the role of neu...|quark,phase,gauge...|\n",
      "|0710.2708|  given a project...|bundle,decomposit...|\n",
      "|0706.0677|  this is the thi...|geodesic,link,ser...|\n",
      "|0707.1652|  the pierre auge...|pose,unit,distrib...|\n",
      "|0809.1051|  we present a ve...|range,quantum,res...|\n",
      "|0704.3951|  ramification in...|filtration,struct...|\n",
      "|0805.4670|  based on firstp...|character,layers,...|\n",
      "|0710.4428|  an asymptotic m...|structures,dynami...|\n",
      "|0712.1683|  recently the in...|wave,molecule,dif...|\n",
      "|0810.0015|  experiments in ...|cell,relation,low...|\n",
      "+---------+--------------------+--------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "df.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$ PMI(A,B) = \\frac{P(A,B)}{P(A)*P(B)}$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$ P(A,B) = \\frac{c((A,B), C_{\\text{pairs}})}{c(C_{\\text{pairs})}} $$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$ P(A) = \\frac{c(A)}{c(C)}, P(B) = \\frac{c(B)}{c(C)} $$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$$ \\text{where C stands for word collection} $$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. How to count words?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "defaultdict(int,\n",
       "            {'conjugate': 4041,\n",
       "             'quantum': 162709,\n",
       "             'lambda': 18154,\n",
       "             'method': 195849,\n",
       "             'quantization': 11050,\n",
       "             'operator': 41743,\n",
       "             'theory': 209686,\n",
       "             'manifold': 25017,\n",
       "             'projector': 701,\n",
       "             'class': 93365,\n",
       "             'order': 179320,\n",
       "             'hamiltonian': 29116,\n",
       "             'values': 82900,\n",
       "             'muon': 7125,\n",
       "             'mass': 133707,\n",
       "             'dipole': 11625,\n",
       "             'physics': 55240,\n",
       "             'boson': 16521,\n",
       "             'restrict': 2868,\n",
       "             'observable': 12736,\n",
       "             'supersymmetry': 9766,\n",
       "             'space': 159070,\n",
       "             'data': 258997,\n",
       "             'moment': 17860,\n",
       "             'parameter': 85152,\n",
       "             'set': 133383,\n",
       "             'construct': 53091,\n",
       "             'decomposition': 17736,\n",
       "             'prime': 11392,\n",
       "             'p': 46533,\n",
       "             'group': 87929,\n",
       "             'subgroup': 8651,\n",
       "             'variety': 34447,\n",
       "             'natural': 45807,\n",
       "             'isogeny': 254,\n",
       "             'exponent': 13927,\n",
       "             'distribution': 108705,\n",
       "             'mechanics': 18512,\n",
       "             'validity': 11483,\n",
       "             'dimension': 43734,\n",
       "             'lagrangian': 14696,\n",
       "             'gauge': 46878,\n",
       "             'flat': 23327,\n",
       "             'spin': 72163,\n",
       "             'invariant': 36480,\n",
       "             'residual': 9115,\n",
       "             'core': 26552,\n",
       "             'sample': 57005,\n",
       "             'sigma': 26276,\n",
       "             'procedure': 29773,\n",
       "             'measure': 57249,\n",
       "             'structure': 150879,\n",
       "             'support': 32302,\n",
       "             'fraction': 32158,\n",
       "             'radius': 29569,\n",
       "             'correlation': 46685,\n",
       "             'symmetry': 63365,\n",
       "             'expression': 20347,\n",
       "             'energy': 185452,\n",
       "             'up': 102368,\n",
       "             'category': 13126,\n",
       "             'stability': 37068,\n",
       "             'torus': 9380,\n",
       "             'component': 40240,\n",
       "             'ball': 5036,\n",
       "             'polyhedron': 711,\n",
       "             'variables': 34635,\n",
       "             'dual': 21616,\n",
       "             'cohomology': 10592,\n",
       "             'vector': 45336,\n",
       "             'norm': 10593,\n",
       "             'polynomial': 26227,\n",
       "             'work': 150235,\n",
       "             'unconfirmed': 82,\n",
       "             'function': 165120,\n",
       "             'scattering': 53790,\n",
       "             'range': 107943,\n",
       "             'photon': 25566,\n",
       "             'scaling': 34275,\n",
       "             'momentum': 42303,\n",
       "             'virtuality': 493,\n",
       "             'hera': 2722,\n",
       "             'proton': 12235,\n",
       "             'luminosity': 28568,\n",
       "             'twist': 4956,\n",
       "             'negative': 27222,\n",
       "             'nilpotent': 3338,\n",
       "             'field': 219386,\n",
       "             'multiplier': 2185,\n",
       "             'anticommutativity': 36,\n",
       "             'string': 23573,\n",
       "             'ring': 20777,\n",
       "             'module': 10039,\n",
       "             'valence': 6193,\n",
       "             'semiconductor': 6446,\n",
       "             'electron': 47485,\n",
       "             'phonon': 7484,\n",
       "             'contrast': 35293,\n",
       "             'coupling': 69801,\n",
       "             'process': 93893,\n",
       "             'distance': 44688,\n",
       "             'bidding': 303,\n",
       "             'realization': 11407,\n",
       "             'beauty': 714,\n",
       "             'record': 3426,\n",
       "             'calligraphy': 12,\n",
       "             'element': 20287,\n",
       "             'selection': 22455,\n",
       "             'infrared': 19341,\n",
       "             'flux': 39995,\n",
       "             'origin': 30419,\n",
       "             'continuum': 22399,\n",
       "             'millimeter': 2361,\n",
       "             'magic': 2221,\n",
       "             'shell': 9586,\n",
       "             'interaction': 74131,\n",
       "             'fission': 1348,\n",
       "             'diffusion': 23037,\n",
       "             'state': 151362,\n",
       "             'differential': 38390,\n",
       "             'multiple': 52069,\n",
       "             'horizon': 12597,\n",
       "             'impulse': 1535,\n",
       "             'kinetics': 3569,\n",
       "             'flow': 46901,\n",
       "             'deposition': 4121,\n",
       "             'stiffness': 2417,\n",
       "             'convection': 4106,\n",
       "             'edge': 24661,\n",
       "             'point': 97158,\n",
       "             'orientation': 9861,\n",
       "             'basis': 35808,\n",
       "             'observatory': 9071,\n",
       "             'myr': 5975,\n",
       "             'metallicity': 10485,\n",
       "             'resolution': 35664,\n",
       "             'galaxy': 47357,\n",
       "             'star': 58636,\n",
       "             'law': 31864,\n",
       "             'cluster': 35228,\n",
       "             'supernova': 10939,\n",
       "             'filter': 8871,\n",
       "             'telescope': 25296,\n",
       "             'low': 101379,\n",
       "             'mechanism': 51298,\n",
       "             'track': 5962,\n",
       "             'limit': 93716,\n",
       "             'locus': 2848,\n",
       "             'phase': 123734,\n",
       "             'fidelity': 5435,\n",
       "             'computation': 27339,\n",
       "             'processing': 23126,\n",
       "             'radiation': 32330,\n",
       "             'sensitivity': 23179,\n",
       "             'power': 69984,\n",
       "             'conjecture': 28836,\n",
       "             'wave': 52607,\n",
       "             'principal': 9962,\n",
       "             'scalar': 43008,\n",
       "             'resonance': 26142,\n",
       "             'bar': 7935,\n",
       "             'spiral': 8355,\n",
       "             'scenario': 31454,\n",
       "             'orbit': 14133,\n",
       "             'period': 26169,\n",
       "             'magnitude': 36667,\n",
       "             'yield': 19470,\n",
       "             'size': 72967,\n",
       "             'nucleation': 3066,\n",
       "             'beam': 21826,\n",
       "             'parallel': 23367,\n",
       "             'feature': 35615,\n",
       "             'metal': 15239,\n",
       "             'reduction': 28963,\n",
       "             'nothing': 1488,\n",
       "             'void': 1393,\n",
       "             'current': 76991,\n",
       "             'volume': 25719,\n",
       "             'spacetime': 28085,\n",
       "             'dispersion': 20470,\n",
       "             'operation': 15458,\n",
       "             'lying': 3637,\n",
       "             'equivalence': 13864,\n",
       "             'normal': 31117,\n",
       "             'complete': 44640,\n",
       "             'series': 40773,\n",
       "             'plane': 35395,\n",
       "             'algebra': 37863,\n",
       "             'supply': 3287,\n",
       "             'torsion': 5455,\n",
       "             'universe': 31515,\n",
       "             'curvature': 23405,\n",
       "             'frequency': 47441,\n",
       "             'dephasing': 2626,\n",
       "             'intensity': 18306,\n",
       "             'bridge': 4351,\n",
       "             'indium': 466,\n",
       "             'tin': 1271,\n",
       "             'niobium': 395,\n",
       "             'transmission': 18928,\n",
       "             'platinum': 346,\n",
       "             'lead': 41130,\n",
       "             'tantalum': 142,\n",
       "             'conductance': 7793,\n",
       "             'hydrogen': 12442,\n",
       "             'ground': 33647,\n",
       "             'flavour': 3628,\n",
       "             'algorithm': 91417,\n",
       "             'inclusion': 8996,\n",
       "             'variable': 28069,\n",
       "             'tree': 14777,\n",
       "             'boosting': 1606,\n",
       "             'regression': 12065,\n",
       "             'simulation': 46775,\n",
       "             'regularization': 8581,\n",
       "             'inference': 16003,\n",
       "             'drug': 1596,\n",
       "             'capability': 7974,\n",
       "             'implementation': 24024,\n",
       "             'list': 8151,\n",
       "             'character': 11603,\n",
       "             'weight': 15808,\n",
       "             'recombination': 4303,\n",
       "             'accretion': 20368,\n",
       "             'stars': 56097,\n",
       "             'oversampling': 322,\n",
       "             'sequence': 35435,\n",
       "             'frame': 14317,\n",
       "             'bundle': 8952,\n",
       "             'reference': 13872,\n",
       "             'cell': 14942,\n",
       "             'rotation': 23358,\n",
       "             'vortex': 10159,\n",
       "             'collar': 64,\n",
       "             'domain': 41254,\n",
       "             'plasma': 20272,\n",
       "             'lattice': 58229,\n",
       "             'conservation': 9396,\n",
       "             'fractal': 4546,\n",
       "             'entropy': 28073,\n",
       "             'l': 30256,\n",
       "             'position': 23608,\n",
       "             'conductor': 1607,\n",
       "             'extinction': 6102,\n",
       "             'redshift': 22873,\n",
       "             'column': 8042,\n",
       "             'interval': 13568,\n",
       "             'permutation': 4172,\n",
       "             'square': 20800,\n",
       "             'waveguide': 3538,\n",
       "             'dielectric': 7847,\n",
       "             'spheres': 5993,\n",
       "             'image': 38746,\n",
       "             'renormalization': 15411,\n",
       "             'equivalent': 32375,\n",
       "             'harmonic': 16365,\n",
       "             'diagram': 22195,\n",
       "             'doping': 8418,\n",
       "             'coulomb': 13097,\n",
       "             'generalization': 25442,\n",
       "             'convexity': 2473,\n",
       "             'hypersurface': 3327,\n",
       "             'millisecond': 2009,\n",
       "             'quadrupole': 3740,\n",
       "             'pulsar': 7129,\n",
       "             'turn': 15945,\n",
       "             'pulse': 11629,\n",
       "             'neutron': 24661,\n",
       "             'object': 26299,\n",
       "             'degree': 40892,\n",
       "             'harassment': 153,\n",
       "             'cover': 10613,\n",
       "             'proof': 39502,\n",
       "             'embedding': 12128,\n",
       "             'planar': 12762,\n",
       "             'anisotropy': 15011,\n",
       "             'ionization': 8214,\n",
       "             'spite': 3795,\n",
       "             'femtosecond': 1757,\n",
       "             'photoionization': 2134,\n",
       "             'reaction': 13953,\n",
       "             'fragmentation': 5158,\n",
       "             'helium': 5691,\n",
       "             'impact': 32176,\n",
       "             'chain': 22045,\n",
       "             'overhead': 4341,\n",
       "             'clock': 2790,\n",
       "             'hybrid': 15777,\n",
       "             'map': 33007,\n",
       "             'scheme': 52925,\n",
       "             'couple': 5443,\n",
       "             'saturation': 6568,\n",
       "             'graphite': 1518,\n",
       "             'magnetization': 12178,\n",
       "             'particle': 52853,\n",
       "             'scale': 67210,\n",
       "             'tevatron': 4066,\n",
       "             'line': 53179,\n",
       "             'derivative': 10721,\n",
       "             'literature': 35049,\n",
       "             'host': 15176,\n",
       "             'coring': 77,\n",
       "             'coalgebra': 462,\n",
       "             'coproduct': 395,\n",
       "             'quiver': 2239,\n",
       "             'spectrum': 74421,\n",
       "             'intrusion': 687,\n",
       "             'key': 45676,\n",
       "             'communication': 20794,\n",
       "             'secrecy': 1235,\n",
       "             'pi': 18923,\n",
       "             'stat': 2456,\n",
       "             'detector': 23774,\n",
       "             'product': 30245,\n",
       "             'finitary': 382,\n",
       "             'photometry': 10225,\n",
       "             'subclass': 2556,\n",
       "             'nova': 1802,\n",
       "             'unfiltered': 105,\n",
       "             'graviton': 2463,\n",
       "             'diffeomorphism': 2054,\n",
       "             'unitarity': 4105,\n",
       "             'resonator': 3405,\n",
       "             'instability': 17238,\n",
       "             'mode': 31945,\n",
       "             'phenomenon': 20060,\n",
       "             'soliton': 5581,\n",
       "             'dynamics': 96352,\n",
       "             'matrix': 60864,\n",
       "             'chirality': 2475,\n",
       "             'transformation': 19011,\n",
       "             'zigzag': 2035,\n",
       "             'flavor': 9615,\n",
       "             'mixing': 23149,\n",
       "             'brane': 6828,\n",
       "             'quark': 27994,\n",
       "             'wavelength': 12405,\n",
       "             'subharmonic': 437,\n",
       "             'logarithm': 2474,\n",
       "             'complement': 6070,\n",
       "             'unit': 19948,\n",
       "             'e': 32979,\n",
       "             'modulus': 5542,\n",
       "             'stream': 4798,\n",
       "             'spectroscopy': 22964,\n",
       "             'interpretation': 22415,\n",
       "             'laser': 18511,\n",
       "             'polarization': 24251,\n",
       "             'estimation': 28710,\n",
       "             'hierarchy': 10108,\n",
       "             'nanopore': 260,\n",
       "             'dna': 3777,\n",
       "             'bandwidth': 7118,\n",
       "             'base': 15419,\n",
       "             'focus': 38507,\n",
       "             'odds': 974,\n",
       "             'phenomenology': 5217,\n",
       "             'technicolor': 541,\n",
       "             'collider': 12181,\n",
       "             'relevance': 8874,\n",
       "             'geometry': 41102,\n",
       "             'halo': 14569,\n",
       "             'annihilation': 6892,\n",
       "             'antiproton': 807,\n",
       "             'relation': 50771,\n",
       "             'drag': 3000,\n",
       "             'signature': 11523,\n",
       "             'upload': 203,\n",
       "             'pp': 8423,\n",
       "             'iptv': 25,\n",
       "             'broadcasting': 546,\n",
       "             'download': 724,\n",
       "             'wavelet': 2831,\n",
       "             'bistability': 848,\n",
       "             'receptor': 504,\n",
       "             'pathological': 763,\n",
       "             'cancer': 2948,\n",
       "             'topology': 17912,\n",
       "             'ion': 14115,\n",
       "             'identification': 13542,\n",
       "             'xenon': 1131,\n",
       "             'event': 20392,\n",
       "             'daughter': 563,\n",
       "             'center': 21838,\n",
       "             'thermal': 39854,\n",
       "             'merge': 2167,\n",
       "             'white': 10918,\n",
       "             'homogeneous': 20243,\n",
       "             'connection': 24673,\n",
       "             'sense': 25299,\n",
       "             'qubit': 7799,\n",
       "             'duality': 12022,\n",
       "             'branching': 10920,\n",
       "             'genus': 7998,\n",
       "             'accounting': 5346,\n",
       "             'signal': 38919,\n",
       "             'microwave': 11976,\n",
       "             'meson': 10822,\n",
       "             'ambiguity': 2770,\n",
       "             'demodulation': 187,\n",
       "             'code': 30624,\n",
       "             'aka': 1230,\n",
       "             'modulation': 10775,\n",
       "             'receiver': 5427,\n",
       "             'coding': 7689,\n",
       "             'centrality': 2792,\n",
       "             'pagerank': 455,\n",
       "             'node': 11140,\n",
       "             'graph': 43216,\n",
       "             'robustness': 12777,\n",
       "             'rank': 16392,\n",
       "             'stratification': 1724,\n",
       "             'observer': 4430,\n",
       "             'irradiation': 2890,\n",
       "             'flare': 4061,\n",
       "             'duration': 7354,\n",
       "             'substructure': 2305,\n",
       "             'asymmetry': 13882,\n",
       "             'becoming': 4864,\n",
       "             'pion': 7907,\n",
       "             'crossover': 8061,\n",
       "             'acceleration': 12966,\n",
       "             'binomial': 1920,\n",
       "             'population': 31850,\n",
       "             'shaping': 2195,\n",
       "             'affect': 13684,\n",
       "             'microscopy': 7620,\n",
       "             'hysteresis': 2835,\n",
       "             'diffraction': 8600,\n",
       "             'perovskite': 1798,\n",
       "             'template': 2684,\n",
       "             'confusion': 1369,\n",
       "             'photography': 205,\n",
       "             'interference': 14529,\n",
       "             'shadow': 1473,\n",
       "             'delta': 22254,\n",
       "             'arsenic': 165,\n",
       "             'sampling': 15707,\n",
       "             'wireless': 9394,\n",
       "             'workload': 1087,\n",
       "             'loop': 19898,\n",
       "             'transistor': 1650,\n",
       "             'channel': 30845,\n",
       "             'alpha': 21314,\n",
       "             'ranging': 10982,\n",
       "             'kinematics': 7672,\n",
       "             'shear': 10558,\n",
       "             'brightness': 9188,\n",
       "             'truncation': 3525,\n",
       "             'requirement': 7848,\n",
       "             'perspective': 11352,\n",
       "             'matching': 14405,\n",
       "             'baryon': 10728,\n",
       "             'nc': 3222,\n",
       "             'parity': 7079,\n",
       "             'history': 12908,\n",
       "             'universality': 7301,\n",
       "             'cosmology': 11714,\n",
       "             'eccentric': 2105,\n",
       "             'planet': 9340,\n",
       "             'eccentricity': 2907,\n",
       "             'excitation': 18887,\n",
       "             'characteristic': 29999,\n",
       "             'hypothesis': 15792,\n",
       "             'synchrotron': 6352,\n",
       "             'nano': 949,\n",
       "             'solid': 11670,\n",
       "             'superspace': 1604,\n",
       "             'view': 25659,\n",
       "             'multiplet': 2061,\n",
       "             'preon': 55,\n",
       "             'planck': 8307,\n",
       "             'arc': 2583,\n",
       "             'path': 22208,\n",
       "             'carry': 9989,\n",
       "             'amplitude': 29479,\n",
       "             'helicity': 3872,\n",
       "             'configuration': 21047,\n",
       "             'dissociation': 2179,\n",
       "             'structures': 53668,\n",
       "             'root': 8313,\n",
       "             'efficiency': 36141,\n",
       "             'witness': 1112,\n",
       "             'multipartite': 1864,\n",
       "             'closeness': 570,\n",
       "             'proxy': 2207,\n",
       "             'trapping': 4466,\n",
       "             'settling': 932,\n",
       "             'criticality': 2978,\n",
       "             'partition': 11134,\n",
       "             'link': 15040,\n",
       "             'convergence': 30760,\n",
       "             'dirac': 17746,\n",
       "             'realisation': 958,\n",
       "             'nucleon': 7981,\n",
       "             'constriction': 309,\n",
       "             'swing': 420,\n",
       "             'convolution': 5120,\n",
       "             'ellipsoid': 883,\n",
       "             'multiplicity': 5814,\n",
       "             'gaussian': 28455,\n",
       "             'hawking': 2782,\n",
       "             'determinant': 4288,\n",
       "             'perturbation': 24238,\n",
       "             'beta': 16081,\n",
       "             'beamline': 493,\n",
       "             'chromaticity': 113,\n",
       "             'limiting': 11447,\n",
       "             'aperture': 3064,\n",
       "             'metrics': 14328,\n",
       "             'property': 34873,\n",
       "             'phy': 175,\n",
       "             'argument': 10117,\n",
       "             'meaning': 6508,\n",
       "             'graphene': 12977,\n",
       "             'voltage': 9333,\n",
       "             'noise': 38256,\n",
       "             'rigour': 76,\n",
       "             'gluon': 8952,\n",
       "             'surgery': 1468,\n",
       "             'homology': 6448,\n",
       "             'taxon': 57,\n",
       "             'interface': 17568,\n",
       "             'stage': 13072,\n",
       "             'statistics': 23100,\n",
       "             'intersection': 7383,\n",
       "             'homotopy': 5494,\n",
       "             'skeleton': 1132,\n",
       "             'projection': 10895,\n",
       "             'representation': 42825,\n",
       "             'reciprocal': 1853,\n",
       "             'fallacy': 96,\n",
       "             'self': 4277,\n",
       "             'estimator': 9330,\n",
       "             'software': 15255,\n",
       "             'correlative': 99,\n",
       "             'turbulence': 10165,\n",
       "             'sponge': 69,\n",
       "             'dissociative': 272,\n",
       "             'desorption': 692,\n",
       "             'serine': 15,\n",
       "             'motion': 47375,\n",
       "             'formalism': 27870,\n",
       "             'plasmon': 2517,\n",
       "             'histogram': 1084,\n",
       "             'parametrization': 3398,\n",
       "             'teleportation': 1429,\n",
       "             'swap': 740,\n",
       "             'lens': 5243,\n",
       "             'delay': 10004,\n",
       "             'correctness': 2693,\n",
       "             'exploit': 10536,\n",
       "             'singularity': 10715,\n",
       "             'dynamo': 2362,\n",
       "             'end': 27932,\n",
       "             'bijection': 1754,\n",
       "             'dichotomy': 1602,\n",
       "             'rigidity': 3355,\n",
       "             'factorization': 7684,\n",
       "             'recoil': 2426,\n",
       "             'chart': 723,\n",
       "             'specification': 3159,\n",
       "             'deadlock': 137,\n",
       "             'atom': 11574,\n",
       "             'amplifier': 1299,\n",
       "             'absorption': 23644,\n",
       "             'interferometry': 3036,\n",
       "             'lithography': 709,\n",
       "             'utilization': 2519,\n",
       "             'harmonics': 2726,\n",
       "             'fifo': 142,\n",
       "             'carton': 7,\n",
       "             'sign': 12149,\n",
       "             'skewness': 1065,\n",
       "             'term': 36620,\n",
       "             'tongue': 167,\n",
       "             'boundary': 51354,\n",
       "             'insertion': 1735,\n",
       "             'dimer': 2417,\n",
       "             'venus': 481,\n",
       "             'association': 6901,\n",
       "             'agonist': 21,\n",
       "             'neurotransmitter': 38,\n",
       "             'spinodal': 636,\n",
       "             'agglomerate': 51,\n",
       "             'dbscan': 96,\n",
       "             'shock': 10618,\n",
       "             'wavenumber': 1445,\n",
       "             'collision': 11580,\n",
       "             'concurrence': 958,\n",
       "             'roof': 197,\n",
       "             'plateau': 3156,\n",
       "             'ejecta': 3610,\n",
       "             'outcome': 6069,\n",
       "             'contraction': 3729,\n",
       "             'moduli': 12221,\n",
       "             'orbifold': 3027,\n",
       "             'oxide': 3888,\n",
       "             'substrate': 7011,\n",
       "             'insulator': 7594,\n",
       "             'monolayer': 4139,\n",
       "             'media': 11216,\n",
       "             'fluorescence': 2819,\n",
       "             'french': 823,\n",
       "             'economics': 1279,\n",
       "             'inequality': 13424,\n",
       "             'censoring': 314,\n",
       "             'rosat': 1967,\n",
       "             'database': 8905,\n",
       "             'cats': 159,\n",
       "             'np': 2763,\n",
       "             'isotropy': 1579,\n",
       "             'parton': 7061,\n",
       "             'subtraction': 2514,\n",
       "             'sky': 13480,\n",
       "             'ridge': 1586,\n",
       "             'nucleosynthesis': 3284,\n",
       "             'workflow': 1153,\n",
       "             'collaboration': 8041,\n",
       "             'community': 10722,\n",
       "             'frustration': 2111,\n",
       "             'perpendicular': 8012,\n",
       "             'neutrino': 22435,\n",
       "             'lepton': 9276,\n",
       "             'section': 19816,\n",
       "             'consistency': 11567,\n",
       "             'corollary': 4366,\n",
       "             'cart': 139,\n",
       "             'polytope': 2206,\n",
       "             'isolation': 2262,\n",
       "             'biasing': 851,\n",
       "             'consumption': 6102,\n",
       "             'chip': 1945,\n",
       "             'calculus': 6717,\n",
       "             'penumbra': 253,\n",
       "             'cadence': 924,\n",
       "             'sunspot': 1252,\n",
       "             'satellite': 8875,\n",
       "             'inversion': 7617,\n",
       "             'envelope': 6162,\n",
       "             'layers': 19701,\n",
       "             'opacity': 2525,\n",
       "             'advantage': 15006,\n",
       "             'derivation': 11087,\n",
       "             'spinor': 3564,\n",
       "             'supergravity': 7294,\n",
       "             'corona': 3678,\n",
       "             'skin': 1483,\n",
       "             'tangent': 4038,\n",
       "             'receipt': 52,\n",
       "             'protocol': 12067,\n",
       "             'division': 3375,\n",
       "             'multiplexing': 1589,\n",
       "             'appendix': 2459,\n",
       "             'inverse': 22651,\n",
       "             'isotope': 1916,\n",
       "             'smallerthan': 1184,\n",
       "             'silicon': 7118,\n",
       "             'conductivity': 11521,\n",
       "             'superlattice': 1337,\n",
       "             'covariance': 7033,\n",
       "             'similarity': 10190,\n",
       "             'pixel': 4222,\n",
       "             'trajectory': 7708,\n",
       "             'quarter': 1003,\n",
       "             'disease': 4808,\n",
       "             'polarimeter': 586,\n",
       "             'calibration': 7459,\n",
       "             'benzene': 400,\n",
       "             'oxygen': 6627,\n",
       "             'diagonal': 6083,\n",
       "             'nitrogen': 2676,\n",
       "             'carbon': 9533,\n",
       "             'jump': 5312,\n",
       "             'divergence': 6771,\n",
       "             'discontinuity': 2302,\n",
       "             'coset': 1543,\n",
       "             'fiber': 6539,\n",
       "             'ell': 5244,\n",
       "             'refinement': 4374,\n",
       "             'monomial': 1735,\n",
       "             'voice': 1086,\n",
       "             'arabic': 390,\n",
       "             'sphinx': 42,\n",
       "             'adaptability': 441,\n",
       "             'povm': 293,\n",
       "             'oscillation': 10976,\n",
       "             'translation': 7848,\n",
       "             'building': 14801,\n",
       "             'softening': 1493,\n",
       "             'afterglow': 2201,\n",
       "             'ray': 7861,\n",
       "             'swift': 2778,\n",
       "             'inertia': 2652,\n",
       "             'wetting': 1034,\n",
       "             'dissipation': 9904,\n",
       "             'pairing': 8359,\n",
       "             'biology': 3550,\n",
       "             'engineering': 9957,\n",
       "             'isospin': 3355,\n",
       "             'demon': 259,\n",
       "             'net': 6339,\n",
       "             'outflow': 5874,\n",
       "             'integer': 17658,\n",
       "             'plan': 2693,\n",
       "             'redistribution': 1529,\n",
       "             'superconductivity': 9759,\n",
       "             'potassium': 580,\n",
       "             'compound': 6169,\n",
       "             'barium': 414,\n",
       "             'tournament': 395,\n",
       "             'magnetoresistance': 3450,\n",
       "             'diode': 1279,\n",
       "             'saddle': 2188,\n",
       "             'holography': 1258,\n",
       "             'jet': 15143,\n",
       "             'opening': 4617,\n",
       "             'modelling': 11669,\n",
       "             'grid': 9532,\n",
       "             'radiance': 229,\n",
       "             'visualization': 3136,\n",
       "             'tracing': 2360,\n",
       "             'astronomy': 4134,\n",
       "             'ibis': 223,\n",
       "             'flattening': 1287,\n",
       "             'closing': 1038,\n",
       "             'neuron': 1549,\n",
       "             'isometry': 2322,\n",
       "             'contamination': 3457,\n",
       "             'stacking': 2491,\n",
       "             'degeneracy': 6654,\n",
       "             'approx': 9130,\n",
       "             'nanotube': 1647,\n",
       "             'sketch': 1786,\n",
       "             'evaporation': 2774,\n",
       "             'hardening': 937,\n",
       "             'damages': 276,\n",
       "             'cutoff': 8155,\n",
       "             'sharpening': 255,\n",
       "             'morphism': 1870,\n",
       "             'lobe': 1455,\n",
       "             'energetics': 1774,\n",
       "             'balance': 8541,\n",
       "             'encoding': 6075,\n",
       "             'reflection': 9499,\n",
       "             'erg': 3193,\n",
       "             'flip': 1428,\n",
       "             'exposure': 4113,\n",
       "             'nebula': 4687,\n",
       "             'gossip': 220,\n",
       "             'duplex': 344,\n",
       "             'whiteboard': 12,\n",
       "             'snow': 436,\n",
       "             'chaotic': 8618,\n",
       "             'penetration': 2710,\n",
       "             'kepler': 3100,\n",
       "             'observability': 1279,\n",
       "             'resultant': 2320,\n",
       "             'tensor': 26212,\n",
       "             'metric': 33766,\n",
       "             'ansatz': 6587,\n",
       "             'branch': 8952,\n",
       "             'bilayer': 4191,\n",
       "             'optics': 7936,\n",
       "             'offset': 3831,\n",
       "             'decidability': 674,\n",
       "             'verification': 6060,\n",
       "             'connectivity': 6378,\n",
       "             'constraint': 19399,\n",
       "             'skew': 2093,\n",
       "             'subalgebra': 2494,\n",
       "             'uncorrelated': 2198,\n",
       "             'mask': 2102,\n",
       "             'aggregate': 2807,\n",
       "             'cone': 7259,\n",
       "             'premises': 249,\n",
       "             'debye': 1240,\n",
       "             'strips': 1041,\n",
       "             'folding': 2049,\n",
       "             'strain': 7571,\n",
       "             'coframe': 72,\n",
       "             'bracket': 1893,\n",
       "             'cantilever': 459,\n",
       "             'diameter': 8038,\n",
       "             'location': 14816,\n",
       "             'tension': 7304,\n",
       "             'constellation': 599,\n",
       "             'labelling': 636,\n",
       "             'assignment': 3727,\n",
       "             'chen': 1355,\n",
       "             'vertex': 15787,\n",
       "             'fermion': 12301,\n",
       "             'terminology': 707,\n",
       "             'streams': 3344,\n",
       "             'normalization': 4153,\n",
       "             'extractor': 587,\n",
       "             'bit': 5548,\n",
       "             'valuation': 1636,\n",
       "             'reliability': 6373,\n",
       "             'uniqueness': 8930,\n",
       "             'percolation': 4787,\n",
       "             'inflation': 9800,\n",
       "             'pathfinder': 438,\n",
       "             'dome': 581,\n",
       "             'debris': 2220,\n",
       "             'ecology': 691,\n",
       "             'exoplanet': 2333,\n",
       "             'broadband': 5717,\n",
       "             'tola': 4,\n",
       "             'narrowband': 1841,\n",
       "             'heterogeneity': 3126,\n",
       "             'metabolite': 85,\n",
       "             'flavonoid': 5,\n",
       "             'genome': 1509,\n",
       "             'germanium': 819,\n",
       "             'overpopulation': 33,\n",
       "             'hadron': 11036,\n",
       "             'permeability': 1179,\n",
       "             'virus': 1157,\n",
       "             'epitope': 23,\n",
       "             'efficacy': 3724,\n",
       "             'effector': 103,\n",
       "             'antigen': 122,\n",
       "             'mount': 382,\n",
       "             'crystal': 17470,\n",
       "             'programming': 11832,\n",
       "             'die': 612,\n",
       "             'management': 7794,\n",
       "             'benchmark': 14128,\n",
       "             'mathematics': 4179,\n",
       "             'reading': 1855,\n",
       "             'originality': 213,\n",
       "             'spots': 2480,\n",
       "             'latitude': 1853,\n",
       "             'incidence': 3052,\n",
       "             'jupiter': 2368,\n",
       "             'locality': 2438,\n",
       "             'postselection': 523,\n",
       "             'provenance': 362,\n",
       "             'workspace': 313,\n",
       "             'refining': 862,\n",
       "             'copycat': 21,\n",
       "             'architecture': 17253,\n",
       "             'schema': 863,\n",
       "             'generality': 2659,\n",
       "             'functor': 2965,\n",
       "             'interior': 7604,\n",
       "             'stress': 9933,\n",
       "             'polymerization': 347,\n",
       "             'trace': 11394,\n",
       "             'grasp': 758,\n",
       "             'arbitrage': 404,\n",
       "             'emphasis': 8905,\n",
       "             'asset': 1730,\n",
       "             'default': 1534,\n",
       "             'anticipation': 321,\n",
       "             'concordance': 1218,\n",
       "             'bubble': 3798,\n",
       "             'divisor': 2521,\n",
       "             'jumping': 473,\n",
       "             'hadronization': 1227,\n",
       "             'molecule': 6822,\n",
       "             'knot': 3895,\n",
       "             'ranking': 3355,\n",
       "             'voting': 1273,\n",
       "             'contest': 270,\n",
       "             'package': 5015,\n",
       "             'underwater': 615,\n",
       "             'magnetosphere': 1546,\n",
       "             'normality': 1601,\n",
       "             'domino': 194,\n",
       "             'resistance': 6292,\n",
       "             'viscosity': 7906,\n",
       "             'omega': 12869,\n",
       "             'centroid': 1210,\n",
       "             'multiferroics': 258,\n",
       "             'polaron': 1184,\n",
       "             'spectrograph': 4058,\n",
       "             'morphology': 8556,\n",
       "             'median': 4577,\n",
       "             'coincidence': 2929,\n",
       "             'ultraviolet': 6830,\n",
       "             'unification': 4064,\n",
       "             'positron': 2019,\n",
       "             'inflow': 1466,\n",
       "             'blueshift': 521,\n",
       "             'nucleus': 8838,\n",
       "             'bulge': 3838,\n",
       "             'throughput': 4936,\n",
       "             'routing': 3417,\n",
       "             'heuristic': 5122,\n",
       "             'competition': 6481,\n",
       "             'ideal': 17750,\n",
       "             'closure': 5206,\n",
       "             'manufacturing': 1536,\n",
       "             'anchoring': 462,\n",
       "             'meniscus': 128,\n",
       "             'cofinal': 80,\n",
       "             'atlas': 4459,\n",
       "             'longevity': 291,\n",
       "             'blockade': 1530,\n",
       "             'semigroup': 3920,\n",
       "             'semiring': 319,\n",
       "             'octant': 233,\n",
       "             'turnover': 998,\n",
       "             'methanol': 790,\n",
       "             'sed': 2798,\n",
       "             'progenitor': 3995,\n",
       "             'hull': 1782,\n",
       "             'maxima': 2448,\n",
       "             'completeness': 3842,\n",
       "             'redundancy': 1870,\n",
       "             'nls': 1175,\n",
       "             'curie': 1530,\n",
       "             'minor': 5141,\n",
       "             'decoupling': 3779,\n",
       "             'causality': 2532,\n",
       "             'codomain': 118,\n",
       "             'arity': 213,\n",
       "             'membrane': 3835,\n",
       "             'turing': 1370,\n",
       "             'deformation': 13049,\n",
       "             'kernel': 13691,\n",
       "             'cloning': 667,\n",
       "             'spins': 11381,\n",
       "             'instrumentation': 1202,\n",
       "             'arithmetic': 5796,\n",
       "             'sieve': 496,\n",
       "             'chemotaxis': 443,\n",
       "             'crowding': 473,\n",
       "             'sage': 264,\n",
       "             'versa': 1961,\n",
       "             'immersion': 830,\n",
       "             'coherence': 10954,\n",
       "             'monoid': 1440,\n",
       "             'eclipse': 1560,\n",
       "             'augment': 1284,\n",
       "             'axion': 2828,\n",
       "             'linearization': 1375,\n",
       "             'germ': 508,\n",
       "             'evolvability': 95,\n",
       "             'demonstrative': 55,\n",
       "             'strategy': 22451,\n",
       "             'thermodynamics': 7779,\n",
       "             'quasar': 5219,\n",
       "             'mediation': 931,\n",
       "             'impurity': 6185,\n",
       "             'nanoparticle': 1304,\n",
       "             'word': 7554,\n",
       "             'alphabet': 1954,\n",
       "             'precipitation': 779,\n",
       "             'comet': 983,\n",
       "             'asteroid': 1416,\n",
       "             'flooding': 288,\n",
       "             'cave': 61,\n",
       "             'permittivity': 1424,\n",
       "             'picosecond': 558,\n",
       "             'ephemeris': 569,\n",
       "             'neptune': 650,\n",
       "             'dissemination': 680,\n",
       "             'queer': 39,\n",
       "             'baseline': 9817,\n",
       "             'quadrat': 7,\n",
       "             'wimp': 1401,\n",
       "             'java': 1102,\n",
       "             'prolog': 266,\n",
       "             'syntax': 1273,\n",
       "             'premise': 554,\n",
       "             'resource': 8967,\n",
       "             'cryptography': 1749,\n",
       "             'chromium': 418,\n",
       "             'creep': 645,\n",
       "             'emulsion': 387,\n",
       "             'chemistry': 4843,\n",
       "             'composition': 13440,\n",
       "             'suite': 3240,\n",
       "             'cylinder': 3267,\n",
       "             'fp': 1476,\n",
       "             'transmitter': 2430,\n",
       "             'server': 3002,\n",
       "             'mistake': 488,\n",
       "             'page': 1474,\n",
       "             'volatility': 2285,\n",
       "             'crunch': 236,\n",
       "             'coincident': 2268,\n",
       "             'analogy': 6419,\n",
       "             'transversality': 382,\n",
       "             'constructive': 2818,\n",
       "             'transversal': 1496,\n",
       "             'lock': 445,\n",
       "             'cube': 2238,\n",
       "             'tomography': 4295,\n",
       "             'inflection': 454,\n",
       "             'strangeness': 1383,\n",
       "             'peripheral': 1309,\n",
       "             'beamforming': 1737,\n",
       "             'joint': 15105,\n",
       "             'planetesimal': 644,\n",
       "             'cascade': 4971,\n",
       "             'plot': 2142,\n",
       "             ...})"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "corpus_temp = df.select(\"extracted\").rdd.repartition(32).flatMap(lambda x: (x[\"extracted\"].split(\",\")))\n",
    "corpus = corpus_temp.countByValue()\n",
    "corpus"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2. How to count cooccurence?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "rdds = df.select(\"extracted\").rdd.repartition(32).map(lambda x: x['extracted'].split(\",\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "defaultdict(int,\n",
       "            {('conjugate', 'quantum'): 490,\n",
       "             ('conjugate', 'lambda'): 60,\n",
       "             ('conjugate', 'method'): 606,\n",
       "             ('conjugate', 'quantization'): 82,\n",
       "             ('conjugate', 'operator'): 298,\n",
       "             ('conjugate', 'theory'): 573,\n",
       "             ('conjugate', 'manifold'): 151,\n",
       "             ('conjugate', 'projector'): 2,\n",
       "             ('conjugate', 'class'): 323,\n",
       "             ('conjugate', 'order'): 419,\n",
       "             ('conjugate', 'hamiltonian'): 176,\n",
       "             ('conjugate', 'values'): 165,\n",
       "             ('quantum', 'lambda'): 1071,\n",
       "             ('quantum', 'method'): 14308,\n",
       "             ('quantum', 'quantization'): 3826,\n",
       "             ('quantum', 'operator'): 6210,\n",
       "             ('quantum', 'theory'): 33044,\n",
       "             ('quantum', 'manifold'): 1522,\n",
       "             ('quantum', 'projector'): 167,\n",
       "             ('quantum', 'class'): 7305,\n",
       "             ('quantum', 'order'): 14504,\n",
       "             ('quantum', 'hamiltonian'): 7526,\n",
       "             ('quantum', 'values'): 6416,\n",
       "             ('lambda', 'method'): 1339,\n",
       "             ('lambda', 'quantization'): 89,\n",
       "             ('lambda', 'operator'): 811,\n",
       "             ('lambda', 'theory'): 2486,\n",
       "             ('lambda', 'manifold'): 326,\n",
       "             ('lambda', 'projector'): 7,\n",
       "             ('lambda', 'class'): 978,\n",
       "             ('lambda', 'order'): 2188,\n",
       "             ('lambda', 'hamiltonian'): 277,\n",
       "             ('lambda', 'values'): 1578,\n",
       "             ('method', 'quantization'): 316,\n",
       "             ('method', 'operator'): 909,\n",
       "             ('method', 'theory'): 3672,\n",
       "             ('method', 'manifold'): 173,\n",
       "             ('method', 'projector'): 13,\n",
       "             ('method', 'class'): 1267,\n",
       "             ('method', 'order'): 4921,\n",
       "             ('method', 'hamiltonian'): 274,\n",
       "             ('method', 'values'): 4834,\n",
       "             ('quantization', 'operator'): 748,\n",
       "             ('quantization', 'theory'): 2773,\n",
       "             ('quantization', 'manifold'): 371,\n",
       "             ('quantization', 'projector'): 11,\n",
       "             ('quantization', 'class'): 575,\n",
       "             ('quantization', 'order'): 878,\n",
       "             ('quantization', 'hamiltonian'): 647,\n",
       "             ('quantization', 'values'): 430,\n",
       "             ('operator', 'theory'): 7385,\n",
       "             ('operator', 'manifold'): 1338,\n",
       "             ('operator', 'projector'): 97,\n",
       "             ('operator', 'class'): 3548,\n",
       "             ('operator', 'order'): 4956,\n",
       "             ('operator', 'hamiltonian'): 1528,\n",
       "             ('operator', 'values'): 1709,\n",
       "             ('theory', 'manifold'): 2725,\n",
       "             ('theory', 'projector'): 139,\n",
       "             ('theory', 'class'): 11805,\n",
       "             ('theory', 'order'): 25274,\n",
       "             ('theory', 'hamiltonian'): 4122,\n",
       "             ('theory', 'values'): 8758,\n",
       "             ('manifold', 'projector'): 24,\n",
       "             ('manifold', 'class'): 2544,\n",
       "             ('manifold', 'order'): 1605,\n",
       "             ('manifold', 'hamiltonian'): 759,\n",
       "             ('manifold', 'values'): 732,\n",
       "             ('projector', 'class'): 48,\n",
       "             ('projector', 'order'): 52,\n",
       "             ('projector', 'hamiltonian'): 43,\n",
       "             ('projector', 'values'): 43,\n",
       "             ('class', 'order'): 1579,\n",
       "             ('class', 'hamiltonian'): 1583,\n",
       "             ('class', 'values'): 3765,\n",
       "             ('order', 'hamiltonian'): 2663,\n",
       "             ('order', 'values'): 8893,\n",
       "             ('hamiltonian', 'values'): 1472,\n",
       "             ('muon', 'mass'): 1459,\n",
       "             ('muon', 'dipole'): 162,\n",
       "             ('muon', 'physics'): 727,\n",
       "             ('muon', 'boson'): 555,\n",
       "             ('muon', 'restrict'): 7,\n",
       "             ('muon', 'observable'): 77,\n",
       "             ('muon', 'supersymmetry'): 124,\n",
       "             ('muon', 'space'): 435,\n",
       "             ('muon', 'data'): 2008,\n",
       "             ('muon', 'moment'): 1010,\n",
       "             ('muon', 'parameter'): 593,\n",
       "             ('mass', 'dipole'): 864,\n",
       "             ('mass', 'physics'): 5701,\n",
       "             ('mass', 'boson'): 5505,\n",
       "             ('mass', 'restrict'): 229,\n",
       "             ('mass', 'observable'): 1704,\n",
       "             ('mass', 'supersymmetry'): 2055,\n",
       "             ('mass', 'space'): 9586,\n",
       "             ('mass', 'data'): 23377,\n",
       "             ('mass', 'moment'): 1872,\n",
       "             ('mass', 'parameter'): 11684,\n",
       "             ('dipole', 'physics'): 97,\n",
       "             ('dipole', 'boson'): 31,\n",
       "             ('dipole', 'restrict'): 2,\n",
       "             ('dipole', 'observable'): 30,\n",
       "             ('dipole', 'supersymmetry'): 22,\n",
       "             ('dipole', 'space'): 279,\n",
       "             ('dipole', 'data'): 265,\n",
       "             ('dipole', 'moment'): 668,\n",
       "             ('dipole', 'parameter'): 328,\n",
       "             ('physics', 'boson'): 1928,\n",
       "             ('physics', 'restrict'): 86,\n",
       "             ('physics', 'observable'): 867,\n",
       "             ('physics', 'supersymmetry'): 856,\n",
       "             ('physics', 'space'): 4869,\n",
       "             ('physics', 'data'): 8155,\n",
       "             ('physics', 'moment'): 826,\n",
       "             ('physics', 'parameter'): 3247,\n",
       "             ('boson', 'restrict'): 49,\n",
       "             ('boson', 'observable'): 298,\n",
       "             ('boson', 'supersymmetry'): 611,\n",
       "             ('boson', 'space'): 1853,\n",
       "             ('boson', 'data'): 3224,\n",
       "             ('boson', 'moment'): 297,\n",
       "             ('boson', 'parameter'): 2052,\n",
       "             ('restrict', 'observable'): 17,\n",
       "             ('restrict', 'supersymmetry'): 29,\n",
       "             ('restrict', 'space'): 474,\n",
       "             ('restrict', 'data'): 441,\n",
       "             ('restrict', 'moment'): 29,\n",
       "             ('restrict', 'parameter'): 236,\n",
       "             ('observable', 'supersymmetry'): 154,\n",
       "             ('observable', 'space'): 1432,\n",
       "             ('observable', 'data'): 1869,\n",
       "             ('observable', 'moment'): 196,\n",
       "             ('observable', 'parameter'): 1007,\n",
       "             ('supersymmetry', 'space'): 1386,\n",
       "             ('supersymmetry', 'data'): 707,\n",
       "             ('supersymmetry', 'moment'): 113,\n",
       "             ('supersymmetry', 'parameter'): 745,\n",
       "             ('space', 'data'): 7009,\n",
       "             ('space', 'moment'): 696,\n",
       "             ('space', 'parameter'): 11450,\n",
       "             ('data', 'moment'): 2149,\n",
       "             ('data', 'parameter'): 12520,\n",
       "             ('moment', 'parameter'): 834,\n",
       "             ('set', 'construct'): 4969,\n",
       "             ('set', 'decomposition'): 1812,\n",
       "             ('set', 'prime'): 1424,\n",
       "             ('set', 'p'): 4827,\n",
       "             ('set', 'group'): 8036,\n",
       "             ('set', 'subgroup'): 1081,\n",
       "             ('set', 'variety'): 3013,\n",
       "             ('set', 'natural'): 5109,\n",
       "             ('set', 'isogeny'): 24,\n",
       "             ('set', 'exponent'): 740,\n",
       "             ('construct', 'decomposition'): 820,\n",
       "             ('construct', 'prime'): 540,\n",
       "             ('construct', 'p'): 1671,\n",
       "             ('construct', 'group'): 5198,\n",
       "             ('construct', 'subgroup'): 628,\n",
       "             ('construct', 'variety'): 1234,\n",
       "             ('construct', 'natural'): 1976,\n",
       "             ('construct', 'isogeny'): 15,\n",
       "             ('construct', 'exponent'): 279,\n",
       "             ('decomposition', 'prime'): 22,\n",
       "             ('decomposition', 'p'): 75,\n",
       "             ('decomposition', 'group'): 201,\n",
       "             ('decomposition', 'subgroup'): 16,\n",
       "             ('decomposition', 'variety'): 55,\n",
       "             ('decomposition', 'natural'): 97,\n",
       "             ('decomposition', 'isogeny'): 5,\n",
       "             ('decomposition', 'exponent'): 28,\n",
       "             ('prime', 'p'): 3800,\n",
       "             ('prime', 'group'): 2235,\n",
       "             ('prime', 'subgroup'): 458,\n",
       "             ('prime', 'variety'): 349,\n",
       "             ('prime', 'natural'): 427,\n",
       "             ('prime', 'isogeny'): 53,\n",
       "             ('prime', 'exponent'): 153,\n",
       "             ('p', 'group'): 4659,\n",
       "             ('p', 'subgroup'): 894,\n",
       "             ('p', 'variety'): 1094,\n",
       "             ('p', 'natural'): 1446,\n",
       "             ('p', 'isogeny'): 45,\n",
       "             ('p', 'exponent'): 638,\n",
       "             ('group', 'subgroup'): 5329,\n",
       "             ('group', 'variety'): 2711,\n",
       "             ('group', 'natural'): 3685,\n",
       "             ('group', 'isogeny'): 75,\n",
       "             ('group', 'exponent'): 771,\n",
       "             ('subgroup', 'variety'): 199,\n",
       "             ('subgroup', 'natural'): 415,\n",
       "             ('subgroup', 'isogeny'): 23,\n",
       "             ('subgroup', 'exponent'): 92,\n",
       "             ('variety', 'natural'): 1323,\n",
       "             ('variety', 'isogeny'): 50,\n",
       "             ('variety', 'exponent'): 174,\n",
       "             ('natural', 'isogeny'): 8,\n",
       "             ('natural', 'exponent'): 238,\n",
       "             ('isogeny', 'exponent'): 1,\n",
       "             ('distribution', 'mechanics'): 1001,\n",
       "             ('distribution', 'validity'): 949,\n",
       "             ('mechanics', 'validity'): 248,\n",
       "             ('dimension', 'lagrangian'): 568,\n",
       "             ('dimension', 'gauge'): 1763,\n",
       "             ('dimension', 'flat'): 850,\n",
       "             ('dimension', 'spin'): 1347,\n",
       "             ('dimension', 'invariant'): 2062,\n",
       "             ('lagrangian', 'gauge'): 1509,\n",
       "             ('lagrangian', 'flat'): 297,\n",
       "             ('lagrangian', 'spin'): 600,\n",
       "             ('lagrangian', 'invariant'): 1045,\n",
       "             ('gauge', 'flat'): 847,\n",
       "             ('gauge', 'spin'): 2874,\n",
       "             ('gauge', 'invariant'): 4192,\n",
       "             ('flat', 'spin'): 857,\n",
       "             ('flat', 'invariant'): 459,\n",
       "             ('spin', 'invariant'): 617,\n",
       "             ('mass', 'residual'): 887,\n",
       "             ('mass', 'core'): 4462,\n",
       "             ('mass', 'sample'): 10372,\n",
       "             ('mass', 'sigma'): 4597,\n",
       "             ('mass', 'procedure'): 1495,\n",
       "             ('mass', 'measure'): 5416,\n",
       "             ('mass', 'structure'): 9829,\n",
       "             ('mass', 'support'): 1946,\n",
       "             ('mass', 'fraction'): 7102,\n",
       "             ('mass', 'radius'): 7796,\n",
       "             ('mass', 'correlation'): 4931,\n",
       "             ('residual', 'core'): 65,\n",
       "             ('residual', 'sample'): 465,\n",
       "             ('residual', 'sigma'): 157,\n",
       "             ('residual', 'procedure'): 214,\n",
       "             ('residual', 'measure'): 381,\n",
       "             ('residual', 'structure'): 714,\n",
       "             ('residual', 'support'): 145,\n",
       "             ('residual', 'fraction'): 179,\n",
       "             ('residual', 'radius'): 130,\n",
       "             ('residual', 'correlation'): 352,\n",
       "             ('core', 'sample'): 1556,\n",
       "             ('core', 'sigma'): 393,\n",
       "             ('core', 'procedure'): 342,\n",
       "             ('core', 'measure'): 926,\n",
       "             ('core', 'structure'): 3906,\n",
       "             ('core', 'support'): 851,\n",
       "             ('core', 'fraction'): 1271,\n",
       "             ('core', 'radius'): 1719,\n",
       "             ('core', 'correlation'): 868,\n",
       "             ('sample', 'sigma'): 2187,\n",
       "             ('sample', 'procedure'): 1290,\n",
       "             ('sample', 'measure'): 4079,\n",
       "             ('sample', 'structure'): 3846,\n",
       "             ('sample', 'support'): 1302,\n",
       "             ('sample', 'fraction'): 4276,\n",
       "             ('sample', 'radius'): 1790,\n",
       "             ('sample', 'correlation'): 4016,\n",
       "             ('sigma', 'procedure'): 285,\n",
       "             ('sigma', 'measure'): 1194,\n",
       "             ('sigma', 'structure'): 1233,\n",
       "             ('sigma', 'support'): 432,\n",
       "             ('sigma', 'fraction'): 1278,\n",
       "             ('sigma', 'radius'): 1028,\n",
       "             ('sigma', 'correlation'): 1375,\n",
       "             ('procedure', 'measure'): 586,\n",
       "             ('procedure', 'structure'): 402,\n",
       "             ('procedure', 'support'): 438,\n",
       "             ('procedure', 'fraction'): 230,\n",
       "             ('procedure', 'radius'): 223,\n",
       "             ('procedure', 'correlation'): 834,\n",
       "             ('measure', 'structure'): 809,\n",
       "             ('measure', 'support'): 1318,\n",
       "             ('measure', 'fraction'): 1461,\n",
       "             ('measure', 'radius'): 1069,\n",
       "             ('measure', 'correlation'): 2572,\n",
       "             ('structure', 'support'): 2849,\n",
       "             ('structure', 'fraction'): 2687,\n",
       "             ('structure', 'radius'): 2213,\n",
       "             ('structure', 'correlation'): 5226,\n",
       "             ('support', 'fraction'): 252,\n",
       "             ('support', 'radius'): 385,\n",
       "             ('support', 'correlation'): 862,\n",
       "             ('fraction', 'radius'): 1156,\n",
       "             ('fraction', 'correlation'): 1567,\n",
       "             ('radius', 'correlation'): 1171,\n",
       "             ('symmetry', 'expression'): 2,\n",
       "             ('symmetry', 'energy'): 75,\n",
       "             ('symmetry', 'up'): 492,\n",
       "             ('expression', 'energy'): 2733,\n",
       "             ('expression', 'up'): 961,\n",
       "             ('energy', 'up'): 2368,\n",
       "             ('dimension', 'category'): 576,\n",
       "             ('dimension', 'stability'): 869,\n",
       "             ('dimension', 'torus'): 491,\n",
       "             ('dimension', 'component'): 803,\n",
       "             ('category', 'stability'): 191,\n",
       "             ('category', 'torus'): 130,\n",
       "             ('category', 'component'): 149,\n",
       "             ('stability', 'torus'): 143,\n",
       "             ('stability', 'component'): 604,\n",
       "             ('torus', 'component'): 280,\n",
       "             ('ball', 'polyhedron'): 9,\n",
       "             ('ball', 'dimension'): 383,\n",
       "             ('ball', 'variables'): 117,\n",
       "             ('ball', 'dual'): 122,\n",
       "             ('ball', 'cohomology'): 16,\n",
       "             ('ball', 'vector'): 189,\n",
       "             ('ball', 'norm'): 290,\n",
       "             ('ball', 'group'): 289,\n",
       "             ('ball', 'polynomial'): 145,\n",
       "             ('ball', 'manifold'): 297,\n",
       "             ('ball', 'space'): 1085,\n",
       "             ('ball', 'decomposition'): 76,\n",
       "             ('polyhedron', 'dimension'): 65,\n",
       "             ('polyhedron', 'variables'): 32,\n",
       "             ('polyhedron', 'dual'): 32,\n",
       "             ('polyhedron', 'cohomology'): 4,\n",
       "             ('polyhedron', 'vector'): 24,\n",
       "             ('polyhedron', 'norm'): 13,\n",
       "             ('polyhedron', 'group'): 66,\n",
       "             ('polyhedron', 'polynomial'): 69,\n",
       "             ('polyhedron', 'manifold'): 38,\n",
       "             ('polyhedron', 'space'): 138,\n",
       "             ('polyhedron', 'decomposition'): 14,\n",
       "             ('dimension', 'variables'): 1067,\n",
       "             ('dimension', 'dual'): 853,\n",
       "             ('dimension', 'cohomology'): 817,\n",
       "             ('dimension', 'vector'): 2283,\n",
       "             ('dimension', 'norm'): 569,\n",
       "             ('dimension', 'group'): 4046,\n",
       "             ('dimension', 'polynomial'): 1287,\n",
       "             ('dimension', 'manifold'): 2349,\n",
       "             ('dimension', 'space'): 7907,\n",
       "             ('dimension', 'decomposition'): 758,\n",
       "             ('variables', 'dual'): 601,\n",
       "             ('variables', 'cohomology'): 101,\n",
       "             ('variables', 'vector'): 1258,\n",
       "             ('variables', 'norm'): 349,\n",
       "             ('variables', 'group'): 1337,\n",
       "             ('variables', 'polynomial'): 1579,\n",
       "             ('variables', 'manifold'): 378,\n",
       "             ('variables', 'space'): 3781,\n",
       "             ('variables', 'decomposition'): 594,\n",
       "             ('dual', 'cohomology'): 406,\n",
       "             ('dual', 'vector'): 1029,\n",
       "             ('dual', 'norm'): 298,\n",
       "             ('dual', 'group'): 2339,\n",
       "             ('dual', 'polynomial'): 485,\n",
       "             ('dual', 'manifold'): 605,\n",
       "             ('dual', 'space'): 3274,\n",
       "             ('dual', 'decomposition'): 424,\n",
       "             ('cohomology', 'vector'): 610,\n",
       "             ('cohomology', 'norm'): 37,\n",
       "             ('cohomology', 'group'): 2687,\n",
       "             ('cohomology', 'polynomial'): 354,\n",
       "             ('cohomology', 'manifold'): 1115,\n",
       "             ('cohomology', 'space'): 1908,\n",
       "             ('cohomology', 'decomposition'): 229,\n",
       "             ('vector', 'norm'): 44,\n",
       "             ('vector', 'group'): 2784,\n",
       "             ('vector', 'polynomial'): 908,\n",
       "             ('vector', 'manifold'): 1784,\n",
       "             ('vector', 'space'): 7620,\n",
       "             ('vector', 'decomposition'): 722,\n",
       "             ('norm', 'group'): 548,\n",
       "             ('norm', 'polynomial'): 378,\n",
       "             ('norm', 'manifold'): 292,\n",
       "             ('norm', 'space'): 2082,\n",
       "             ('norm', 'decomposition'): 301,\n",
       "             ('group', 'polynomial'): 1942,\n",
       "             ('group', 'manifold'): 3559,\n",
       "             ('group', 'space'): 13644,\n",
       "             ('group', 'decomposition'): 1391,\n",
       "             ('polynomial', 'manifold'): 407,\n",
       "             ('polynomial', 'space'): 2601,\n",
       "             ('polynomial', 'decomposition'): 577,\n",
       "             ('manifold', 'space'): 4281,\n",
       "             ('manifold', 'decomposition'): 415,\n",
       "             ('space', 'decomposition'): 2262,\n",
       "             ('work', 'unconfirmed'): 9,\n",
       "             ('work', 'support'): 3486,\n",
       "             ('unconfirmed', 'support'): 5,\n",
       "             ('p', 'function'): 4595,\n",
       "             ('p', 'scattering'): 212,\n",
       "             ('p', 'range'): 392,\n",
       "             ('p', 'photon'): 122,\n",
       "             ('p', 'scaling'): 115,\n",
       "             ('p', 'momentum'): 321,\n",
       "             ('p', 'energy'): 4161,\n",
       "             ('p', 'data'): 5819,\n",
       "             ('p', 'virtuality'): 53,\n",
       "             ('p', 'structure'): 3918,\n",
       "             ('p', 'fraction'): 847,\n",
       "             ('p', 'method'): 3138,\n",
       "             ('p', 'hera'): 235,\n",
       "             ('p', 'mass'): 448,\n",
       "             ('p', 'component'): 943,\n",
       "             ('p', 'proton'): 746,\n",
       "             ('p', 'luminosity'): 119,\n",
       "             ('p', 'twist'): 141,\n",
       "             ('p', 'negative'): 820,\n",
       "             ('function', 'scattering'): 1223,\n",
       "             ('function', 'range'): 2954,\n",
       "             ('function', 'photon'): 597,\n",
       "             ('function', 'scaling'): 1412,\n",
       "             ('function', 'momentum'): 1467,\n",
       "             ('function', 'energy'): 5412,\n",
       "             ('function', 'data'): 6072,\n",
       "             ('function', 'virtuality'): 39,\n",
       "             ('function', 'structure'): 4137,\n",
       "             ('function', 'fraction'): 1862,\n",
       "             ('function', 'method'): 20815,\n",
       "             ('function', 'hera'): 437,\n",
       "             ('function', 'mass'): 3863,\n",
       "             ('function', 'component'): 3307,\n",
       "             ('function', 'proton'): 1271,\n",
       "             ('function', 'luminosity'): 1324,\n",
       "             ('function', 'twist'): 138,\n",
       "             ('function', 'negative'): 1271,\n",
       "             ('scattering', 'range'): 3446,\n",
       "             ('scattering', 'photon'): 2524,\n",
       "             ('scattering', 'scaling'): 1225,\n",
       "             ('scattering', 'momentum'): 4016,\n",
       "             ('scattering', 'energy'): 11189,\n",
       "             ('scattering', 'data'): 9438,\n",
       "             ('scattering', 'virtuality'): 145,\n",
       "             ('scattering', 'structure'): 6353,\n",
       "             ('scattering', 'fraction'): 1011,\n",
       "             ('scattering', 'method'): 5578,\n",
       "             ('scattering', 'hera'): 729,\n",
       "             ('scattering', 'mass'): 2728,\n",
       "             ('scattering', 'component'): 1401,\n",
       "             ('scattering', 'proton'): 1836,\n",
       "             ('scattering', 'luminosity'): 746,\n",
       "             ('scattering', 'twist'): 389,\n",
       "             ('scattering', 'negative'): 995,\n",
       "             ('range', 'photon'): 2796,\n",
       "             ('range', 'scaling'): 3480,\n",
       "             ('range', 'momentum'): 3700,\n",
       "             ('range', 'energy'): 19745,\n",
       "             ('range', 'data'): 24215,\n",
       "             ('range', 'virtuality'): 102,\n",
       "             ('range', 'structure'): 10768,\n",
       "             ('range', 'fraction'): 4653,\n",
       "             ('range', 'method'): 11419,\n",
       "             ('range', 'hera'): 380,\n",
       "             ('range', 'mass'): 8410,\n",
       "             ('range', 'component'): 3803,\n",
       "             ('range', 'proton'): 1532,\n",
       "             ('range', 'luminosity'): 5025,\n",
       "             ('range', 'twist'): 240,\n",
       "             ('range', 'negative'): 1950,\n",
       "             ('photon', 'scaling'): 357,\n",
       "             ('photon', 'momentum'): 1654,\n",
       "             ('photon', 'energy'): 6278,\n",
       "             ('photon', 'data'): 4121,\n",
       "             ('photon', 'virtuality'): 268,\n",
       "             ('photon', 'structure'): 1880,\n",
       "             ('photon', 'fraction'): 805,\n",
       "             ('photon', 'method'): 1953,\n",
       "             ('photon', 'hera'): 396,\n",
       "             ('photon', 'mass'): 422,\n",
       "             ('photon', 'component'): 802,\n",
       "             ('photon', 'proton'): 663,\n",
       "             ('photon', 'luminosity'): 257,\n",
       "             ('photon', 'twist'): 108,\n",
       "             ('photon', 'negative'): 328,\n",
       "             ('scaling', 'momentum'): 1116,\n",
       "             ('scaling', 'energy'): 5107,\n",
       "             ('scaling', 'data'): 5098,\n",
       "             ('scaling', 'virtuality'): 26,\n",
       "             ('scaling', 'structure'): 3062,\n",
       "             ('scaling', 'fraction'): 866,\n",
       "             ('scaling', 'method'): 3584,\n",
       "             ('scaling', 'hera'): 101,\n",
       "             ('scaling', 'mass'): 557,\n",
       "             ('scaling', 'component'): 541,\n",
       "             ('scaling', 'proton'): 209,\n",
       "             ('scaling', 'luminosity'): 148,\n",
       "             ('scaling', 'twist'): 113,\n",
       "             ('scaling', 'negative'): 536,\n",
       "             ('momentum', 'energy'): 10901,\n",
       "             ('momentum', 'data'): 6028,\n",
       "             ('momentum', 'virtuality'): 116,\n",
       "             ('momentum', 'structure'): 4266,\n",
       "             ('momentum', 'fraction'): 1345,\n",
       "             ('momentum', 'method'): 3209,\n",
       "             ('momentum', 'hera'): 346,\n",
       "             ('momentum', 'mass'): 1162,\n",
       "             ('momentum', 'component'): 1023,\n",
       "             ('momentum', 'proton'): 1226,\n",
       "             ('momentum', 'luminosity'): 189,\n",
       "             ('momentum', 'twist'): 367,\n",
       "             ('momentum', 'negative'): 853,\n",
       "             ('energy', 'data'): 19335,\n",
       "             ('energy', 'virtuality'): 121,\n",
       "             ('energy', 'structure'): 9129,\n",
       "             ('energy', 'fraction'): 4946,\n",
       "             ('energy', 'method'): 15937,\n",
       "             ('energy', 'hera'): 477,\n",
       "             ('energy', 'mass'): 3167,\n",
       "             ('energy', 'component'): 4712,\n",
       "             ('energy', 'proton'): 3095,\n",
       "             ('energy', 'luminosity'): 1087,\n",
       "             ('energy', 'twist'): 70,\n",
       "             ('energy', 'negative'): 4465,\n",
       "             ('data', 'virtuality'): 161,\n",
       "             ('data', 'structure'): 10749,\n",
       "             ('data', 'fraction'): 7320,\n",
       "             ('data', 'method'): 35781,\n",
       "             ('data', 'hera'): 1194,\n",
       "             ('data', 'mass'): 3705,\n",
       "             ('data', 'component'): 7749,\n",
       "             ('data', 'proton'): 3177,\n",
       "             ('data', 'luminosity'): 1408,\n",
       "             ('data', 'twist'): 60,\n",
       "             ('data', 'negative'): 3450,\n",
       "             ('virtuality', 'structure'): 7,\n",
       "             ('virtuality', 'fraction'): 28,\n",
       "             ('virtuality', 'method'): 13,\n",
       "             ('virtuality', 'hera'): 98,\n",
       "             ('virtuality', 'mass'): 18,\n",
       "             ('virtuality', 'component'): 15,\n",
       "             ('virtuality', 'proton'): 51,\n",
       "             ('virtuality', 'luminosity'): 8,\n",
       "             ('virtuality', 'twist'): 3,\n",
       "             ('virtuality', 'negative'): 5,\n",
       "             ('structure', 'method'): 15121,\n",
       "             ('structure', 'hera'): 459,\n",
       "             ('structure', 'mass'): 2045,\n",
       "             ('structure', 'component'): 3641,\n",
       "             ('structure', 'proton'): 1511,\n",
       "             ('structure', 'luminosity'): 465,\n",
       "             ('structure', 'twist'): 114,\n",
       "             ('structure', 'negative'): 2230,\n",
       "             ('fraction', 'method'): 2107,\n",
       "             ('fraction', 'hera'): 101,\n",
       "             ('fraction', 'mass'): 1351,\n",
       "             ('fraction', 'component'): 1369,\n",
       "             ('fraction', 'proton'): 358,\n",
       "             ('fraction', 'luminosity'): 564,\n",
       "             ('fraction', 'twist'): 12,\n",
       "             ('fraction', 'negative'): 253,\n",
       "             ('method', 'hera'): 80,\n",
       "             ('method', 'mass'): 1313,\n",
       "             ('method', 'component'): 999,\n",
       "             ('method', 'proton'): 791,\n",
       "             ('method', 'luminosity'): 310,\n",
       "             ('method', 'twist'): 103,\n",
       "             ('method', 'negative'): 640,\n",
       "             ('hera', 'mass'): 39,\n",
       "             ('hera', 'component'): 11,\n",
       "             ('hera', 'proton'): 278,\n",
       "             ('hera', 'luminosity'): 29,\n",
       "             ('hera', 'twist'): 13,\n",
       "             ('hera', 'negative'): 6,\n",
       "             ('mass', 'component'): 5374,\n",
       "             ('mass', 'proton'): 1831,\n",
       "             ('mass', 'luminosity'): 10062,\n",
       "             ('mass', 'twist'): 340,\n",
       "             ('mass', 'negative'): 2410,\n",
       "             ('component', 'proton'): 328,\n",
       "             ('component', 'luminosity'): 911,\n",
       "             ('component', 'twist'): 39,\n",
       "             ('component', 'negative'): 205,\n",
       "             ('proton', 'luminosity'): 65,\n",
       "             ('proton', 'twist'): 31,\n",
       "             ('proton', 'negative'): 75,\n",
       "             ('luminosity', 'twist'): 17,\n",
       "             ('luminosity', 'negative'): 243,\n",
       "             ('twist', 'negative'): 95,\n",
       "             ('nilpotent', 'field'): 285,\n",
       "             ('nilpotent', 'lagrangian'): 72,\n",
       "             ('nilpotent', 'vector'): 179,\n",
       "             ('nilpotent', 'theory'): 509,\n",
       "             ('nilpotent', 'multiplier'): 32,\n",
       "             ('nilpotent', 'gauge'): 201,\n",
       "             ('nilpotent', 'symmetry'): 139,\n",
       "             ('nilpotent', 'anticommutativity'): 19,\n",
       "             ('field', 'lagrangian'): 3761,\n",
       "             ('field', 'vector'): 9521,\n",
       "             ('field', 'theory'): 48610,\n",
       "             ('field', 'multiplier'): 230,\n",
       "             ('field', 'gauge'): 13269,\n",
       "             ('field', 'symmetry'): 12931,\n",
       "             ('field', 'anticommutativity'): 7,\n",
       "             ('lagrangian', 'vector'): 1130,\n",
       "             ('lagrangian', 'theory'): 4270,\n",
       "             ('lagrangian', 'multiplier'): 101,\n",
       "             ('lagrangian', 'symmetry'): 1701,\n",
       "             ('lagrangian', 'anticommutativity'): 5,\n",
       "             ('vector', 'theory'): 6732,\n",
       "             ('vector', 'multiplier'): 83,\n",
       "             ('vector', 'gauge'): 2195,\n",
       "             ('vector', 'symmetry'): 2654,\n",
       "             ('vector', 'anticommutativity'): 2,\n",
       "             ('theory', 'multiplier'): 276,\n",
       "             ('theory', 'gauge'): 15797,\n",
       "             ('theory', 'symmetry'): 13055,\n",
       "             ('theory', 'anticommutativity'): 11,\n",
       "             ('multiplier', 'gauge'): 36,\n",
       "             ('multiplier', 'symmetry'): 46,\n",
       "             ('multiplier', 'anticommutativity'): 1,\n",
       "             ('gauge', 'symmetry'): 8690,\n",
       "             ('gauge', 'anticommutativity'): 11,\n",
       "             ('symmetry', 'anticommutativity'): 10,\n",
       "             ('mechanics', 'string'): 309,\n",
       "             ('class', 'ring'): 112,\n",
       "             ('class', 'module'): 562,\n",
       "             ('ring', 'module'): 963,\n",
       "             ('energy', 'field'): 303,\n",
       "             ('energy', 'valence'): 1365,\n",
       "             ('energy', 'semiconductor'): 1017,\n",
       "             ('field', 'valence'): 762,\n",
       "             ('field', 'semiconductor'): 1322,\n",
       "             ('valence', 'semiconductor'): 37,\n",
       "             ('electron', 'phonon'): 915,\n",
       "             ('electron', 'contrast'): 1427,\n",
       "             ('electron', 'coupling'): 4312,\n",
       "             ('electron', 'structure'): 6124,\n",
       "             ('phonon', 'contrast'): 181,\n",
       "             ('phonon', 'coupling'): 1851,\n",
       "             ('phonon', 'structure'): 1128,\n",
       "             ('contrast', 'coupling'): 1663,\n",
       "             ('contrast', 'structure'): 3216,\n",
       "             ('coupling', 'structure'): 3342,\n",
       "             ('scaling', 'process'): 2019,\n",
       "             ('scaling', 'measure'): 1332,\n",
       "             ('scaling', 'distance'): 1176,\n",
       "             ('scaling', 'bidding'): 2,\n",
       "             ('scaling', 'realization'): 160,\n",
       "             ('process', 'data'): 16326,\n",
       "             ('process', 'measure'): 4195,\n",
       "             ('process', 'distance'): 1940,\n",
       "             ('process', 'bidding'): 34,\n",
       "             ('process', 'realization'): 538,\n",
       "             ('data', 'measure'): 9152,\n",
       "             ('data', 'distance'): 8839,\n",
       "             ('data', 'bidding'): 53,\n",
       "             ('data', 'realization'): 509,\n",
       "             ('measure', 'distance'): 2785,\n",
       "             ('measure', 'bidding'): 10,\n",
       "             ('measure', 'realization'): 172,\n",
       "             ('distance', 'bidding'): 3,\n",
       "             ('distance', 'realization'): 115,\n",
       "             ('bidding', 'realization'): 2,\n",
       "             ('beauty', 'record'): 1,\n",
       "             ('beauty', 'calligraphy'): 1,\n",
       "             ('beauty', 'element'): 7,\n",
       "             ('record', 'calligraphy'): 1,\n",
       "             ('record', 'element'): 35,\n",
       "             ('calligraphy', 'element'): 1,\n",
       "             ('selection', 'field'): 1712,\n",
       "             ('selection', 'infrared'): 317,\n",
       "             ('selection', 'flux'): 529,\n",
       "             ('selection', 'sample'): 3093,\n",
       "             ('selection', 'origin'): 263,\n",
       "             ('selection', 'energy'): 1803,\n",
       "             ('selection', 'continuum'): 192,\n",
       "             ('selection', 'order'): 2324,\n",
       "             ('selection', 'class'): 1090,\n",
       "             ('selection', 'millimeter'): 64,\n",
       "             ('selection', 'component'): 560,\n",
       "             ('field', 'infrared'): 2784,\n",
       "             ('field', 'flux'): 9096,\n",
       "             ('field', 'sample'): 7442,\n",
       "             ('field', 'origin'): 4859,\n",
       "             ('field', 'energy'): 31603,\n",
       "             ('field', 'continuum'): 2796,\n",
       "             ('field', 'order'): 27011,\n",
       "             ('field', 'class'): 9284,\n",
       "             ('field', 'millimeter'): 214,\n",
       "             ('field', 'component'): 5370,\n",
       "             ('infrared', 'flux'): 1633,\n",
       "             ('infrared', 'sample'): 2303,\n",
       "             ('infrared', 'origin'): 708,\n",
       "             ('infrared', 'energy'): 2961,\n",
       "             ('infrared', 'continuum'): 1228,\n",
       "             ('infrared', 'order'): 2249,\n",
       "             ('infrared', 'class'): 820,\n",
       "             ('infrared', 'millimeter'): 250,\n",
       "             ('infrared', 'component'): 704,\n",
       "             ('flux', 'sample'): 3302,\n",
       "             ('flux', 'origin'): 1808,\n",
       "             ('flux', 'energy'): 9593,\n",
       "             ('flux', 'continuum'): 1745,\n",
       "             ('flux', 'order'): 4310,\n",
       "             ('flux', 'class'): 1106,\n",
       "             ('flux', 'millimeter'): 213,\n",
       "             ('flux', 'component'): 2024,\n",
       "             ('sample', 'origin'): 1298,\n",
       "             ('sample', 'energy'): 4605,\n",
       "             ('sample', 'continuum'): 1396,\n",
       "             ('sample', 'order'): 4879,\n",
       "             ('sample', 'class'): 2276,\n",
       "             ('sample', 'millimeter'): 152,\n",
       "             ('sample', 'component'): 1553,\n",
       "             ('origin', 'energy'): 5021,\n",
       "             ('origin', 'continuum'): 618,\n",
       "             ('origin', 'order'): 3459,\n",
       "             ('origin', 'class'): 1186,\n",
       "             ('origin', 'millimeter'): 66,\n",
       "             ('origin', 'component'): 1259,\n",
       "             ('energy', 'continuum'): 2166,\n",
       "             ('energy', 'order'): 20750,\n",
       "             ('energy', 'class'): 5390,\n",
       "             ('energy', 'millimeter'): 277,\n",
       "             ('continuum', 'order'): 2200,\n",
       "             ('continuum', 'class'): 1066,\n",
       "             ('continuum', 'millimeter'): 351,\n",
       "             ('continuum', 'component'): 1105,\n",
       "             ('order', 'class'): 7958,\n",
       "             ('order', 'millimeter'): 215,\n",
       "             ('order', 'component'): 3683,\n",
       "             ('class', 'millimeter'): 68,\n",
       "             ('class', 'component'): 1483,\n",
       "             ('millimeter', 'component'): 94,\n",
       "             ('mass', 'magic'): 82,\n",
       "             ('mass', 'shell'): 1478,\n",
       "             ('mass', 'theory'): 14538,\n",
       "             ('mass', 'stability'): 2669,\n",
       "             ('mass', 'interaction'): 5313,\n",
       "             ('mass', 'fission'): 282,\n",
       "             ('mass', 'values'): 9308,\n",
       "             ('magic', 'shell'): 159,\n",
       "             ('magic', 'theory'): 246,\n",
       "             ('magic', 'stability'): 73,\n",
       "             ('magic', 'interaction'): 150,\n",
       "             ('magic', 'fission'): 36,\n",
       "             ('magic', 'values'): 143,\n",
       "             ('shell', 'theory'): 1157,\n",
       "             ('shell', 'stability'): 292,\n",
       "             ('shell', 'interaction'): 918,\n",
       "             ('shell', 'fission'): 120,\n",
       "             ('shell', 'values'): 571,\n",
       "             ('theory', 'stability'): 4315,\n",
       "             ('theory', 'interaction'): 8002,\n",
       "             ('theory', 'fission'): 154,\n",
       "             ('stability', 'interaction'): 1309,\n",
       "             ('stability', 'fission'): 48,\n",
       "             ('stability', 'values'): 1754,\n",
       "             ('interaction', 'fission'): 96,\n",
       "             ('interaction', 'values'): 3864,\n",
       "             ('fission', 'values'): 47,\n",
       "             ('process', 'vector'): 1732,\n",
       "             ('process', 'diffusion'): 3373,\n",
       "             ('process', 'state'): 9493,\n",
       "             ('process', 'differential'): 2443,\n",
       "             ('process', 'multiple'): 3606,\n",
       "             ('process', 'horizon'): 850,\n",
       "             ('process', 'impulse'): 121,\n",
       "             ('vector', 'diffusion'): 289,\n",
       "             ('vector', 'state'): 3084,\n",
       "             ('vector', 'differential'): 1613,\n",
       "             ('vector', 'multiple'): 1133,\n",
       "             ('vector', 'horizon'): 377,\n",
       "             ('vector', 'impulse'): 56,\n",
       "             ('diffusion', 'state'): 2078,\n",
       "             ('diffusion', 'differential'): 1145,\n",
       "             ('diffusion', 'multiple'): 573,\n",
       "             ('diffusion', 'horizon'): 123,\n",
       "             ('diffusion', 'impulse'): 33,\n",
       "             ('state', 'differential'): 2323,\n",
       "             ('state', 'multiple'): 3974,\n",
       "             ('state', 'horizon'): 1203,\n",
       "             ('state', 'impulse'): 163,\n",
       "             ('differential', 'multiple'): 757,\n",
       "             ('differential', 'horizon'): 194,\n",
       "             ('differential', 'impulse'): 64,\n",
       "             ('multiple', 'horizon'): 216,\n",
       "             ('multiple', 'impulse'): 65,\n",
       "             ('horizon', 'impulse'): 18,\n",
       "             ('kinetics', 'flow'): 117,\n",
       "             ('kinetics', 'deposition'): 65,\n",
       "             ('kinetics', 'p'): 51,\n",
       "             ('kinetics', 'flux'): 99,\n",
       "             ('kinetics', 'diffusion'): 343,\n",
       "             ('kinetics', 'stiffness'): 22,\n",
       "             ('kinetics', 'convection'): 9,\n",
       "             ('kinetics', 'edge'): 30,\n",
       "             ('kinetics', 'state'): 495,\n",
       "             ('kinetics', 'function'): 313,\n",
       "             ('kinetics', 'point'): 138,\n",
       "             ('kinetics', 'orientation'): 46,\n",
       "             ('flow', 'deposition'): 223,\n",
       "             ('flow', 'p'): 664,\n",
       "             ('flow', 'flux'): 2224,\n",
       "             ('flow', 'diffusion'): 1407,\n",
       "             ('flow', 'stiffness'): 91,\n",
       "             ('flow', 'convection'): 863,\n",
       "             ('flow', 'edge'): 890,\n",
       "             ('flow', 'state'): 4211,\n",
       "             ('flow', 'function'): 3894,\n",
       "             ('flow', 'point'): 3259,\n",
       "             ('flow', 'orientation'): 481,\n",
       "             ('deposition', 'p'): 58,\n",
       "             ('deposition', 'flux'): 139,\n",
       "             ('deposition', 'diffusion'): 198,\n",
       "             ('deposition', 'stiffness'): 8,\n",
       "             ('deposition', 'convection'): 13,\n",
       "             ('deposition', 'edge'): 81,\n",
       "             ('deposition', 'state'): 253,\n",
       "             ('deposition', 'function'): 237,\n",
       "             ('deposition', 'point'): 151,\n",
       "             ('deposition', 'orientation'): 124,\n",
       "             ('p', 'flux'): 391,\n",
       "             ('p', 'diffusion'): 377,\n",
       "             ('p', 'stiffness'): 46,\n",
       "             ('p', 'convection'): 74,\n",
       "             ('p', 'edge'): 821,\n",
       "             ('p', 'state'): 3801,\n",
       "             ('p', 'point'): 3186,\n",
       "             ('p', 'orientation'): 195,\n",
       "             ('flux', 'diffusion'): 796,\n",
       "             ('flux', 'stiffness'): 29,\n",
       "             ('flux', 'convection'): 581,\n",
       "             ('flux', 'edge'): 755,\n",
       "             ('flux', 'state'): 3636,\n",
       "             ('flux', 'function'): 2475,\n",
       "             ('flux', 'point'): 1800,\n",
       "             ('flux', 'orientation'): 311,\n",
       "             ('diffusion', 'stiffness'): 36,\n",
       "             ('diffusion', 'convection'): 365,\n",
       "             ('diffusion', 'edge'): 283,\n",
       "             ('diffusion', 'function'): 2522,\n",
       "             ('diffusion', 'point'): 1302,\n",
       "             ('diffusion', 'orientation'): 196,\n",
       "             ('stiffness', 'convection'): 7,\n",
       "             ('stiffness', 'edge'): 41,\n",
       "             ('stiffness', 'state'): 360,\n",
       "             ('stiffness', 'function'): 217,\n",
       "             ('stiffness', 'point'): 156,\n",
       "             ('stiffness', 'orientation'): 37,\n",
       "             ('convection', 'edge'): 44,\n",
       "             ('convection', 'state'): 268,\n",
       "             ('convection', 'function'): 218,\n",
       "             ('convection', 'point'): 118,\n",
       "             ('convection', 'orientation'): 49,\n",
       "             ('edge', 'state'): 1467,\n",
       "             ('edge', 'function'): 1709,\n",
       "             ('edge', 'point'): 1473,\n",
       "             ('edge', 'orientation'): 273,\n",
       "             ('state', 'function'): 12245,\n",
       "             ('state', 'point'): 7947,\n",
       "             ('state', 'orientation'): 791,\n",
       "             ('function', 'point'): 11501,\n",
       "             ('function', 'orientation'): 865,\n",
       "             ('point', 'orientation'): 499,\n",
       "             ('basis', 'observatory'): 149,\n",
       "             ('basis', 'myr'): 92,\n",
       "             ('basis', 'metallicity'): 200,\n",
       "             ('basis', 'function'): 3855,\n",
       "             ('basis', 'resolution'): 739,\n",
       "             ('basis', 'radius'): 452,\n",
       "             ('basis', 'galaxy'): 769,\n",
       "             ('basis', 'star'): 821,\n",
       "             ('basis', 'law'): 661,\n",
       "             ('basis', 'cluster'): 938,\n",
       "             ('basis', 'supernova'): 128,\n",
       "             ('basis', 'filter'): 201,\n",
       "             ('basis', 'data'): 5709,\n",
       "             ('basis', 'telescope'): 429,\n",
       "             ('basis', 'low'): 1825,\n",
       "             ('basis', 'luminosity'): 436,\n",
       "             ('basis', 'mechanism'): 978,\n",
       "             ('basis', 'track'): 107,\n",
       "             ('basis', 'limit'): 1683,\n",
       "             ('basis', 'locus'): 41,\n",
       "             ('observatory', 'myr'): 118,\n",
       "             ('observatory', 'metallicity'): 190,\n",
       "             ('observatory', 'function'): 433,\n",
       "             ('observatory', 'resolution'): 915,\n",
       "             ('observatory', 'radius'): 343,\n",
       "             ('observatory', 'galaxy'): 925,\n",
       "             ('observatory', 'star'): 1159,\n",
       "             ('observatory', 'law'): 58,\n",
       "             ('observatory', 'cluster'): 86,\n",
       "             ('observatory', 'supernova'): 380,\n",
       "             ('observatory', 'filter'): 134,\n",
       "             ('observatory', 'data'): 3380,\n",
       "             ('observatory', 'telescope'): 2476,\n",
       "             ('observatory', 'low'): 351,\n",
       "             ('observatory', 'luminosity'): 138,\n",
       "             ('observatory', 'mechanism'): 182,\n",
       "             ('observatory', 'track'): 66,\n",
       "             ('observatory', 'limit'): 509,\n",
       "             ('observatory', 'locus'): 5,\n",
       "             ('myr', 'metallicity'): 477,\n",
       "             ('myr', 'function'): 651,\n",
       "             ('myr', 'resolution'): 451,\n",
       "             ('myr', 'radius'): 579,\n",
       "             ('myr', 'galaxy'): 1382,\n",
       "             ('myr', 'star'): 2182,\n",
       "             ('myr', 'law'): 53,\n",
       "             ('myr', 'cluster'): 252,\n",
       "             ('myr', 'supernova'): 75,\n",
       "             ('myr', 'filter'): 28,\n",
       "             ('myr', 'data'): 1542,\n",
       "             ('myr', 'telescope'): 682,\n",
       "             ('myr', 'low'): 225,\n",
       "             ('myr', 'luminosity'): 157,\n",
       "             ('myr', 'mechanism'): 65,\n",
       "             ('myr', 'track'): 38,\n",
       "             ('myr', 'limit'): 469,\n",
       "             ('myr', 'locus'): 15,\n",
       "             ('metallicity', 'function'): 1269,\n",
       "             ('metallicity', 'resolution'): 732,\n",
       "             ('metallicity', 'radius'): 783,\n",
       "             ('metallicity', 'galaxy'): 3287,\n",
       "             ('metallicity', 'star'): 2547,\n",
       "             ('metallicity', 'law'): 47,\n",
       "             ('metallicity', 'cluster'): 204,\n",
       "             ('metallicity', 'supernova'): 85,\n",
       "             ('metallicity', 'filter'): 22,\n",
       "             ('metallicity', 'data'): 713,\n",
       "             ('metallicity', 'telescope'): 971,\n",
       "             ('metallicity', 'low'): 450,\n",
       "             ('metallicity', 'luminosity'): 250,\n",
       "             ('metallicity', 'mechanism'): 56,\n",
       "             ('metallicity', 'track'): 14,\n",
       "             ('metallicity', 'limit'): 202,\n",
       "             ('metallicity', 'locus'): 21,\n",
       "             ('function', 'resolution'): 2555,\n",
       "             ('function', 'radius'): 3466,\n",
       "             ('function', 'galaxy'): 6285,\n",
       "             ('function', 'star'): 4424,\n",
       "             ('function', 'law'): 1131,\n",
       "             ('function', 'cluster'): 1085,\n",
       "             ('function', 'supernova'): 197,\n",
       "             ('function', 'filter'): 272,\n",
       "             ('function', 'telescope'): 1765,\n",
       "             ('function', 'low'): 2686,\n",
       "             ('function', 'mechanism'): 1038,\n",
       "             ('function', 'track'): 132,\n",
       "             ('function', 'limit'): 3156,\n",
       "             ('function', 'locus'): 151,\n",
       "             ('resolution', 'radius'): 483,\n",
       "             ('resolution', 'galaxy'): 3255,\n",
       "             ('resolution', 'star'): 3157,\n",
       "             ('resolution', 'law'): 169,\n",
       "             ('resolution', 'cluster'): 305,\n",
       "             ('resolution', 'supernova'): 137,\n",
       "             ('resolution', 'filter'): 107,\n",
       "             ('resolution', 'data'): 2837,\n",
       "             ('resolution', 'telescope'): 2981,\n",
       "             ('resolution', 'low'): 1002,\n",
       "             ('resolution', 'luminosity'): 313,\n",
       "             ('resolution', 'mechanism'): 197,\n",
       "             ('resolution', 'track'): 154,\n",
       "             ('resolution', 'limit'): 729,\n",
       "             ('resolution', 'locus'): 23,\n",
       "             ('radius', 'galaxy'): 3911,\n",
       "             ('radius', 'star'): 4163,\n",
       "             ('radius', 'law'): 237,\n",
       "             ('radius', 'cluster'): 427,\n",
       "             ('radius', 'supernova'): 125,\n",
       "             ('radius', 'filter'): 39,\n",
       "             ('radius', 'data'): 1693,\n",
       "             ('radius', 'telescope'): 1303,\n",
       "             ('radius', 'low'): 679,\n",
       "             ('radius', 'luminosity'): 522,\n",
       "             ('radius', 'mechanism'): 205,\n",
       "             ('radius', 'track'): 35,\n",
       "             ('radius', 'limit'): 769,\n",
       "             ('radius', 'locus'): 14,\n",
       "             ('galaxy', 'star'): 9145,\n",
       "             ('galaxy', 'law'): 316,\n",
       "             ('galaxy', 'cluster'): 1229,\n",
       "             ('galaxy', 'supernova'): 550,\n",
       "             ('galaxy', 'filter'): 128,\n",
       "             ('galaxy', 'data'): 3673,\n",
       "             ('galaxy', 'telescope'): 4725,\n",
       "             ('galaxy', 'low'): 1969,\n",
       "             ('galaxy', 'luminosity'): 1257,\n",
       "             ('galaxy', 'mechanism'): 333,\n",
       "             ('galaxy', 'track'): 54,\n",
       "             ('galaxy', 'limit'): 906,\n",
       "             ('galaxy', 'locus'): 31,\n",
       "             ('star', 'law'): 367,\n",
       "             ('star', 'cluster'): 872,\n",
       "             ('star', 'supernova'): 1248,\n",
       "             ('star', 'filter'): 171,\n",
       "             ('star', 'data'): 5592,\n",
       "             ('star', 'telescope'): 5140,\n",
       "             ('star', 'low'): 2510,\n",
       "             ('star', 'luminosity'): 1262,\n",
       "             ('star', 'mechanism'): 1005,\n",
       "             ('star', 'track'): 175,\n",
       "             ('star', 'limit'): 1631,\n",
       "             ('star', 'locus'): 43,\n",
       "             ('law', 'cluster'): 732,\n",
       "             ('law', 'supernova'): 277,\n",
       "             ('law', 'filter'): 125,\n",
       "             ('law', 'data'): 4603,\n",
       "             ('law', 'telescope'): 559,\n",
       "             ('law', 'low'): 2366,\n",
       "             ('law', 'luminosity'): 282,\n",
       "             ('law', 'mechanism'): 1010,\n",
       "             ('law', 'track'): 102,\n",
       "             ('law', 'limit'): 3266,\n",
       "             ('law', 'locus'): 34,\n",
       "             ('cluster', 'supernova'): 454,\n",
       "             ...})"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from itertools import combinations\n",
    "corpus2_temp = rdds.flatMap(lambda x: combinations(x,2))\n",
    "corpus2 = corpus2_temp.countByValue()\n",
    "corpus2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3. How to avoid bottleneck?\n",
    "\n",
    "- Use clusters!"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4. Save Result Here"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "# corpus_temp.repartition(8).saveAsTextFile(\"./corpus_final.txt\")\n",
    "# corpus2_temp.repartition(8).saveAsTextFile(\"./corpus2_final.txt\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load from file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 327,
   "metadata": {},
   "outputs": [],
   "source": [
    "# corpus = spark.sparkContext.textFile(\"./corpus_final.txt\").countByValue()\n",
    "# corpus2 = spark.sparkContext.textFile(\"./corpus2_final.txt\").countByValue()\n",
    "\n",
    "\"\"\"\n",
    "Clean corpus when read from file\n",
    "Since we are loading from a textfile, tuples are converted into strings\n",
    "\"\"\"\n",
    "# from collections import defaultdict\n",
    "# corpus_temp = defaultdict(int)\n",
    "\n",
    "# corpus = dict(map(lambda x: (x[0].strip(), x[1]), corpus.items()))\n",
    "# for k, v in corpus2.items():\n",
    "#     k1, k2 = re.sub(\"'\", \"\", k.strip('\"()')).split(\",\")\n",
    "#     k2 = k2.strip()\n",
    "#     w1, w2 = min(k1, k2), max(k1, k2)\n",
    "#     corpus_temp[(w1, w2)] += v\n",
    "# corpus2 = corpus_temp"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Draw Graph"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "metadata": {},
   "outputs": [],
   "source": [
    "freq_threshold = 0\n",
    "PMI_threshold = 10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "metadata": {},
   "outputs": [],
   "source": [
    "import networkx as nx\n",
    "import math\n",
    "import pdb\n",
    "G = nx.Graph()\n",
    "\n",
    "total_word_freq = sum(corpus.values())\n",
    "total_pair_freq = sum(corpus2.values())\n",
    "for (n1, n2), cooccurence in corpus2.items():\n",
    "    if corpus[n1] > freq_threshold and corpus[n2] > freq_threshold and cooccurence:\n",
    "        pa = corpus[n1] / total_word_freq\n",
    "        pb = corpus[n2] / total_word_freq\n",
    "        pab = cooccurence / total_pair_freq\n",
    "        \n",
    "        pmi = math.log(pab/(pa*pb), 2)\n",
    "        G.add_edge(n1, n2, weight=pmi)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Top 10 Related Keywords\n",
    "\n",
    "- Please type `your query` here\n",
    "- Sample queries include\n",
    "        gene, class, theory, stat, dimension, state"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- Sample PMI\n",
    "\n",
    "| word 1 | word 2 | count word 1 | count word2 | co-occurence | pmi            |\n",
    "|--------|--------|--------------|-------------|--------------|----------------|\n",
    "| puerto | rico   | 1938         | 1311        | 1159         | 10.0349081703  |\n",
    "| car    | driver | 5578         | 2749        | 1384         | 8.41470768304  |\n",
    "| it     | the    | 283891       | 3293296     | 3347         | -1.72037278119 |\n",
    "| of     | and    | 1761436      | 1375396     | 1190         | -3.70663100173 |\n",
    "\n",
    "- Reference: https://en.wikipedia.org/wiki/Pointwise_mutual_information"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('patriarchy', {'weight': 21.569935731346103}),\n",
       " ('solidarity', {'weight': 17.400010729903787}),\n",
       " ('meter', {'weight': 11.037579806057254}),\n",
       " ('astronomy', {'weight': 9.556613057920654}),\n",
       " ('white', {'weight': 8.155514749599684}),\n",
       " ('center', {'weight': 7.155382616518959}),\n",
       " ('telescope', {'weight': 6.94331407898773}),\n",
       " ('impact', {'weight': 6.596238365040749}),\n",
       " ('support', {'weight': 6.590599858680719})]"
      ]
     },
     "execution_count": 144,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = 'colonialism'\n",
    "sorted(G.adj[query].items(), key=lambda x: x[1]['weight'], reverse=True)[:10]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Top 10 Related Words"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "query: spastic\n",
      "result: hypertonia, reflex, muscle\n",
      "\n",
      "query: hypertonia\n",
      "result: spastic, reflex, muscle\n",
      "\n",
      "query: jatropha\n",
      "result: endophyte, colonization, crop\n",
      "\n",
      "query: endophyte\n",
      "result: jatropha, colonization, crop\n",
      "\n",
      "query: thrombopoietin\n",
      "result: thrombopoiesis, megakaryocyte, platelet\n",
      "\n",
      "query: thrombopoiesis\n",
      "result: thrombopoietin, megakaryocyte, platelet\n",
      "\n",
      "query: megakaryocyte\n",
      "result: thrombopoietin, thrombopoiesis, platelet\n",
      "\n",
      "query: mamluk\n",
      "result: terracotta, mesopotamia, lustre\n",
      "\n",
      "query: terracotta\n",
      "result: mamluk, mesopotamia, lustre\n",
      "\n",
      "query: colonialism\n",
      "result: patriarchy, solidarity, meter\n",
      "\n"
     ]
    }
   ],
   "source": [
    "result = list()\n",
    "for i, q in enumerate(list(G.nodes)):\n",
    "    weight = sorted(G.adj[q].items(), key=lambda x: x[1]['weight'], reverse=True)[:3]\n",
    "    \n",
    "    if len(weight)==0:\n",
    "        r1, r2, r3 = 0, 0, 0\n",
    "        pmi = 0\n",
    "    elif len(weight)==1:\n",
    "        r1, r2, r3 = weight[0][0], 0, 0\n",
    "        pmi = weight[0][1]['weight']\n",
    "    elif len(weight)==2:\n",
    "        r1, r2, r3 = weight[0][0], weight[1][0], 0\n",
    "        pmi = weight[0][1]['weight']\n",
    "    else:\n",
    "        r1, r2, r3 = weight[0][0], weight[1][0], weight[2][0]\n",
    "        pmi = weight[0][1]['weight']\n",
    "    \n",
    "    result.append((q, r1, r2, r3, pmi))\n",
    "\n",
    "result.sort(key=lambda x: x[4], reverse=True)\n",
    "\n",
    "for q, r1, r2, r3, _ in result[:10]:\n",
    "    print(\"query: {}\".format(q))\n",
    "    print(\"result: {0}, {1}, {2}\\n\".format(r1, r2, r3))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Visualization"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- reference: https://stackoverflow.com/questions/29838746/how-to-draw-subgraph-using-networkx"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "- https://machinelearningmastery.com/develop-word-embeddings-python-gensim/\n",
    "- https://web.stanford.edu/class/cs224n/assignments/a1_preview/exploring_word_vectors.html"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 237,
   "metadata": {},
   "outputs": [],
   "source": [
    "samples = [\"spastic\", \"hypertonia\", \"reflex\", \"muscle\", \"endophyte\", \"jatropha\", \"colonization\", \"crop\", \"colonialism\", \"patriarchy\", \"solidarity\", \"meter\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 296,
   "metadata": {},
   "outputs": [],
   "source": [
    "matrix = list()\n",
    "for i, row in enumerate(l):\n",
    "    row_temp = list()\n",
    "    for j, col in enumerate(l):\n",
    "        w1, w2 = l[i], l[j]\n",
    "        if G.adj.get(w1, 0) and G.adj[w1].get(w2, 0) and G.adj[w1][w2].get(\"weight\", 0):\n",
    "            row_temp.append(G.adj[w1][w2][\"weight\"])\n",
    "        else:\n",
    "            row_temp.append(0)\n",
    "    matrix.append(row_temp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 325,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.decomposition import PCA\n",
    "\n",
    "pca = PCA(n_components=2)\n",
    "result = pca.fit_transform(matrix)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 326,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x1080 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(result[:, 0], result[:, 1])\n",
    "for i, word in enumerate(l):\n",
    "    plt.annotate(word, xy=(result[i, 0], result[i, 1]))\n",
    "\n",
    "plt.figure(figsize=(15,15))\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Testing partition"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "References\n",
    "- running pyspark in jupyter\n",
    "    - https://medium.com/@Vatsal410/running-pyspark-on-an-aws-cluster-through-jupyter-notebook-fe28f6ef47a4\n",
    "- https://medium.com/@christo.lagali/run-jupyter-notebooks-with-pyspark-on-an-emr-cluster-9630ef54c4e1\n",
    "- https://towardsdatascience.com/getting-started-with-pyspark-on-amazon-emr-c85154b6b921\n",
    "- reading and writing s3\n",
    "    - https://docs.cloudera.com/runtime/7.0.2/developing-spark-applications/topics/spark-examples-of-accessing-s3-data-from-spark.html\n",
    "- textmining in apache spark\n",
    "    - https://runawayhorse001.github.io/LearningApacheSpark/textmining.html\n",
    "- https://medium.com/@serkansakinmaz/how-to-connect-amazon-s3-via-emr-based-pyspark-42707d540881\n",
    "- How to setup spark cluster in AWS\n",
    "    - https://aws.amazon.com/blogs/big-data/best-practices-for-successfully-managing-memory-for-apache-spark-applications-on-amazon-emr/"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3.7.4 64-bit",
   "language": "python",
   "name": "python37464bit3209f78e23784fe7aad1ed6f75489d02"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
